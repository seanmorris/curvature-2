!function(){"use strict";var e="undefined"==typeof global?self:global;if("function"!=typeof e.require){var t={},r={},i={},s={}.hasOwnProperty,n=/^\.\.?(\/|$)/,a=function(e,t){for(var r,i=[],s=(n.test(t)?e+"/"+t:t).split("/"),a=0,o=s.length;a<o;a++)".."===(r=s[a])?i.pop():"."!==r&&""!==r&&i.push(r);return i.join("/")},o=function(e){return e.split("/").slice(0,-1).join("/")},l=function(t,i){var s,n={id:t,exports:{},hot:v&&v.createHot(t)};return r[t]=n,i(n.exports,(s=t,function(t){var r=a(o(s),t);return e.require(r,s)}),n),n.exports},u=function(e){var t=i[e];return t&&e!==t?u(t):e},c=function(e,i){null==i&&(i="/");var n=u(e);if(s.call(r,n))return r[n].exports;if(s.call(t,n))return l(n,t[n]);throw new Error("Cannot find module '"+e+"' from '"+i+"'")};c.alias=function(e,t){i[t]=e};var h=/\.[^.\/]+$/,d=/\/index(\.[^\/]+)?$/;c.register=c.define=function(e,n){if(e&&"object"==typeof e)for(var a in e)s.call(e,a)&&c.register(a,e[a]);else t[e]=n,delete r[e],function(e){if(h.test(e)){var t=e.replace(h,"");s.call(i,t)&&i[t].replace(h,"")!==t+"/index"||(i[t]=e)}if(d.test(e)){var r=e.replace(d,"");s.call(i,r)||(i[r]=e)}}(e)},c.list=function(){var e=[];for(var r in t)s.call(t,r)&&e.push(r);return e};var v=e._hmr&&new e._hmr(function(e,t){return u(a(o(e),t))},c,t,r);c._cache=r,c.hmr=v&&v.wrap,c.brunch=!0,e.require=c}}(),function(){"undefined"==typeof window||window;require.register("curvature/Config.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Config=void 0;e.Config={title:"Curvature 0.0.66-r"}}),require.register("curvature/access/LoginView.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LoginView=void 0;var i=t("../base/Config"),s=t("../base/View"),n=t("../base/Router"),a=t("../base/Repository"),o=t("./UserRepository"),l=t("../toast/Toast"),u=t("../toast/ToastAlert");e.LoginView=class extends s.View{constructor(){super(),this.template='\n\t\t\t<a cv-link = "user">User</a>\n\t\t\t<br />\n\t\t\t\n\t\t\t<a cv-link = "user/login">Login</a>\n\t\t\t<br />\n\n\t\t\t<a cv-link = "user/register">Register</a>\n\t\t\t<br />\n\n\t\t\t<a cv-link = "user/logout">Logout</a>\n\t\t\t<br />\n\n\t\t\t<input\n\t\t\t\ttype  = "button"\n\t\t\t\tvalue = "Login via FaceBook"\n\t\t\t \tcv-on = "click:facebookLogin(event)"\n\t\t\t />\n\t\t\t <input\n\t\t\t\ttype  = "button"\n\t\t\t\tvalue = "Log Out"\n\t\t\t \tcv-on = "click:logout(event)"\n\t\t\t />\n\t\t'}facebookLogin(e){console.log("fb!"),e.preventDefault(),window.open(i.Config.get("backend")+"/facebookLogin"),this.userCheck&&this.clearInterval(this.userCheck),this.userCheck=this.onInterval(333,()=>{o.UserRepository.getCurrentUser(!0).then(e=>{var t=e.body;t.id&&t&&(this.clearInterval(this.userCheck),n.Router.clearCache(),a.Repository.clearCache(),l.Toast.instance().pop(new u.ToastAlert({title:"Logged in as "+t.username,body:"ID: "+t.publicId,time:2400})))})})}logout(e){window.open(i.Config.get("backend")+"/user/logout?page=app%3Fclose%3D1")}}}),require.register("curvature/access/UserRepository.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UserRepository=void 0;var i=t("../base/Config"),s=t("../base/Bindable"),n=t("../base/Repository");class a extends n.Repository{static get uri(){return i.Config.get("backend")+"/user/"}static getCurrentUser(e=null){if(!window.prerenderer&&!navigator.userAgent.match(/prerender/i))return this.args.response&&!1===e?Promise.resolve(this.args.response):this.request(this.uri+"current",!1,!1).then(e=>{if(e.body&&e.body.roles)for(var t in e.body.roles)"SeanMorris\\Access\\Role\\Administrator"==e.body.roles[t].class&&(e.body.isAdmin=!0);return e.body&&e.body.id&&(this.args.response=e,this.args.current=e.body),e}).catch(e=>{console.error(e)});window.prerenderer=window.prerenderer||!0}static login(){return this.request(this.uri+"/login")}static logout(){var e=this.args.current;return delete this.args.current,this.request(this.uri+"logout",!1,{},!1).then(()=>(this.args.current=null,e))}static onChange(e){return this.args.bindTo("current",e)}}e.UserRepository=a,Object.defineProperty(a,"args",{configurable:!1,writable:!1,value:s.Bindable.makeBindable({})}),n.Repository.onResponse(e=>{e&&e.meta&&"currentUser"in e.meta&&(!a.args.current||e.meta.currentUser.id!==a.args.current.id)&&(a.args.current=e.meta.currentUser)})}),require.register("curvature/animate/Chain.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Chain=void 0;e.Chain=class{}}),require.register("curvature/animate/Ease.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Ease=void 0;var i=t("../base/Mixin"),s=t("../mixin/PromiseMixin");e.Ease=class extends(i.Mixin.with(s.PromiseMixin)){constructor(e,t={}){super(),this.interval=e,this.terminal=!1,this.initial=!1,this.timeout=!1,this.final=!1,this.canceled=!1,this.done=!1,this.calculate=!!(this.calculate||"calculate"in t)&&t.calculate,this.bounded=!("bounded"in t)||t.bounded,this.repeat="repeat"in t?t.repeat:1,this.reverse="reverse"in t&&t.reverse}start(){this.done=!1,requestAnimationFrame(()=>{this.initial=Date.now(),this.terminal=this.initial+this.interval,this.repeat>=0&&(this.terminal=this.initial+this.interval*this.repeat,this.timeout=setTimeout(()=>{if(this.done)return this.reverse?0:1;this.done=!0,this[s.PromiseMixin.Accept](this.reverse?0:1)},this.interval*this.repeat))})}cancel(){return this.done?this.final:(clearTimeout(this.timeout),this.final=this.current(),this.canceled=this.done=!0,this[s.PromiseMixin.Reject](this.final),this.final)}fraction(){if(this.done)return this.reverse?0:1;if(!1===this.initial)return this.reverse?1:0;var e=Date.now()-this.initial;if(e/this.interval>=this.repeat)return this.reverse?0:1;var t=e%this.interval/this.interval;return this.reverse?1-t:t}current(){var e=this.fraction();return this.calculate?this.calculate(e):e}}}),require.register("curvature/animate/ease/CubicIn.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CubicIn=void 0;var i=t("../Ease");function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.CubicIn=class extends i.Ease{constructor(...e){super(...e),s(this,"calculate",e=>e*e*e)}}}),require.register("curvature/animate/ease/CubicInOut.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CubicInOut=void 0;var i=t("../Ease");function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.CubicInOut=class extends i.Ease{constructor(...e){super(...e),s(this,"calculate",e=>e<.5?4*e*e*e:(e-1)*(2*e-2)*(2*e-2)+1)}}}),require.register("curvature/animate/ease/CubicOut.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CubicOut=void 0;var i=t("../Ease");function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.CubicOut=class extends i.Ease{constructor(...e){super(...e),s(this,"calculate",e=>--e*e*e+1)}}}),require.register("curvature/animate/ease/ElasticOut.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ElasticOut=void 0;var i=t("../Ease");function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.ElasticOut=class extends i.Ease{constructor(e,t={}){super(e,t),s(this,"calculate",e=>Math.pow(2,-10*e)*Math.sin((e-this.friction/4)*(2*Math.PI)/this.friction)+1),this.friction=this.friction||"friction"in t?t.friction:.3}}}),require.register("curvature/animate/ease/GeoIn.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GeoIn=void 0;var i=t("../Ease");e.GeoIn=class extends i.Ease{constructor(e,t={}){super(e,t)}}}),require.register("curvature/animate/ease/GeoInOut.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GeoInOut=void 0;var i,s,n,a=t("../Ease"),o=t("./GeoIn");t("./GeoOut");console.log(o.GeoIn);class l extends a.Ease{calculate(e){return e<.5?EaseIn(power)(2*e)/2:EaseOut(power)(2*e-1)/2+.5}}e.GeoInOut=l,i=l,n=1,(s=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(s="power"))in i?Object.defineProperty(i,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[s]=n}),require.register("curvature/animate/ease/GeoOut.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.GeoOut=void 0;var i=t("../Ease");function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.GeoOut=class extends i.Ease{constructor(e,t={}){super(e,t),s(this,"calculate",e=>1-Math.abs(e-1**this.power)),this.power=this.power||"power"in t?t.power:1}}}),require.register("curvature/animate/ease/Linear.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Linear=void 0;var i=t("../Ease");e.Linear=class extends i.Ease{}}),require.register("curvature/animate/ease/QuadIn.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.QuadIn=void 0;var i=t("../Ease");e.QuadIn=class extends i.Ease{current(){var e=this.fraction();return e*e}}}),require.register("curvature/animate/ease/QuadInOut.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.QuadInOut=void 0;var i=t("../Ease");function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.QuadInOut=class extends i.Ease{constructor(...e){super(...e),s(this,"calculate",e=>e<.5?2*e*e:(4-2*e)*e-1)}}}),require.register("curvature/animate/ease/QuadOut.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.QuadOut=void 0;var i=t("../Ease");e.QuadOut=class extends i.Ease{current(){var e=this.fraction();return e*(2-e)}}}),require.register("curvature/animate/ease/QuartIn.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.QuartIn=void 0;var i=t("../Ease");function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.QuartIn=class extends i.Ease{constructor(...e){super(...e),s(this,"calculate",e=>e*e*e*e)}}}),require.register("curvature/animate/ease/QuartInOut.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.QuartInOut=void 0;var i=t("../Ease");function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.QuartInOut=class extends i.Ease{constructor(...e){super(...e),s(this,"calculate",e=>e<.5?8*e*e*e*e:1-8*--e*e*e*e)}}}),require.register("curvature/animate/ease/QuartOut.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.QuartOut=void 0;var i=t("../Ease");function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.QuartOut=class extends i.Ease{constructor(...e){super(...e),s(this,"calculate",e=>1- --e*e*e*e)}}}),require.register("curvature/animate/ease/QuintIn.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.QuintIn=void 0;var i=t("../Ease");function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.QuintIn=class extends i.Ease{constructor(...e){super(...e),s(this,"calculate",e=>e*e*e*e*e)}}}),require.register("curvature/animate/ease/QuintInOut.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.QuintInOut=void 0;var i=t("../Ease");function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.QuintInOut=class extends i.Ease{constructor(...e){super(...e),s(this,"calculate",e=>e<.5?16*e*e*e*e*e:1+16*--e*e*e*e*e)}}}),require.register("curvature/animate/ease/QuintOut.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.QuintOut=void 0;var i=t("../Ease");function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.QuintOut=class extends i.Ease{constructor(...e){super(...e),s(this,"calculate",e=>1+--e*e*e*e*e)}}}),require.register("curvature/animate/ease/SineIn.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SineIn=void 0;var i=t("../Ease");function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.SineIn=class extends i.Ease{constructor(...e){super(...e),s(this,"calculate",e=>1+Math.sin(Math.PI/2*e-Math.PI/2))}}}),require.register("curvature/animate/ease/SineInOut.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SineInOut=void 0;var i=t("../Ease");function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.SineInOut=class extends i.Ease{constructor(...e){super(...e),s(this,"calculate",e=>(1+Math.sin(Math.PI*e-Math.PI/2))/2)}}}),require.register("curvature/animate/ease/SineOut.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SineOut=void 0;var i=t("../Ease");function s(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.SineOut=class extends i.Ease{constructor(...e){super(...e),s(this,"calculate",e=>Math.sin(Math.PI/2*e))}}}),require.register("curvature/base/Bag.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Bag=void 0;var i=t("./Bindable"),s=t("./Mixin"),n=t("../mixin/EventTargetMixin"),a=e=>Number(e),o=Symbol("Mapped"),l=Symbol("Has"),u=Symbol("Add"),c=Symbol("Remove"),h=Symbol("Delete");class d extends(s.Mixin.with(n.EventTargetMixin)){constructor(e){super(),this.changeCallback=e,this.content=new Map,this.current=0,this.length=0,this.list=i.Bindable.makeBindable([]),this.meta=Symbol("meta"),this.type=void 0}has(e){return this[o]?this[o].has(e):this[l](e)}[l](e){return this.content.has(e)}add(e){return this[o]?this[o].add(e):this[u](e)}[u](e){if(void 0===e||!(e instanceof Object))throw new Error("Only objects may be added to Bags.");if(this.type&&!(e instanceof this.type))throw console.error(this.type,e),new Error(`Only objects of type ${this.type} may be added to this Bag.`);if(e=i.Bindable.make(e),!this.content.has(e)){var t=new CustomEvent("adding",{detail:{item:e}});if(this.dispatchEvent(t)){var r=a(this.current++);this.content.set(e,r),this.list[r]=e,this.changeCallback&&this.changeCallback(e,this.meta,d.ITEM_ADDED,r);var s=new CustomEvent("added",{detail:{item:e,id:r}});return this.dispatchEvent(s),this.length=this.size,r}}}remove(e){return this[o]?this[o].remove(e):this[c](e)}[c](e){if(void 0===e||!(e instanceof Object))throw new Error("Only objects may be removed from Bags.");if(this.type&&!(e instanceof this.type))throw console.error(this.type,e),new Error(`Only objects of type ${this.type} may be removed from this Bag.`);if(e=i.Bindable.make(e),!this.content.has(e))return this.changeCallback&&this.changeCallback(e,this.meta,0,void 0),!1;var t=new CustomEvent("removing",{detail:{item:e}});if(this.dispatchEvent(t)){var r=this.content.get(e);delete this.list[r],this.content.delete(e),this.changeCallback&&this.changeCallback(e,this.meta,d.ITEM_REMOVED,r);var s=new CustomEvent("removed",{detail:{item:e,id:r}});return this.dispatchEvent(s),this.length=this.size,e}}delete(e){if(this[o])return this[o].delete(e);this[h](e)}[h](e){this.remove(e)}map(e=(e=>e),t=(e=>e)){var r=new WeakMap,i=new d;return i[o]=this,this.addEventListener("added",s=>{var n=s.detail.item;if(t(n)&&!r.has(n)){var a=e(n);r.set(n,a),i[u](a)}}),this.addEventListener("removed",e=>{var t=e.detail.item;if(r.has(t)){var s=r.get(t);r.delete(t),i[c](s)}}),i}get size(){return this.content.size}items(){return Array.from(this.content.entries()).map(e=>e[0])}}e.Bag=d,Object.defineProperty(d,"ITEM_ADDED",{configurable:!1,enumerable:!1,writable:!0,value:1}),Object.defineProperty(d,"ITEM_REMOVED",{configurable:!1,enumerable:!1,writable:!0,value:-1})}),require.register("curvature/base/Bindable.js",function(e,t,r){"use strict";function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(e,"__esModule",{value:!0}),e.Bindable=void 0;var s=Symbol("ref"),n=Symbol("original"),a=Symbol("deck"),o=Symbol("binding"),l=Symbol("subBinding"),u=Symbol("bindingAll"),c=Symbol("isBindable"),h=Symbol("wrapping"),d=Symbol("Names"),v=Symbol("executing"),p=Symbol("stack"),f=(Symbol("object"),Symbol("wrapped")),m=Symbol("unwrapped"),g=Symbol("getProto"),b=Symbol("onGet"),y=Symbol("onAllGet"),w=Symbol("bindChain"),j=Symbol("Descriptors"),E=Symbol("Before"),P=Symbol("After"),_=Symbol("NoGetters"),T=Symbol("Prevent"),S=Object.getPrototypeOf(Int8Array),O=Set.prototype[Symbol.iterator],C=Map.prototype[Symbol.iterator],k="object"==typeof globalThis?globalThis:"object"==typeof window?window:"object"==typeof self?self:void 0,x=e=>"function"==typeof k.Map&&e instanceof k.Map||"function"==typeof k.Set&&e instanceof k.Set||"function"==typeof k.Node&&e instanceof k.Node||"function"==typeof k.WeakMap&&e instanceof k.WeakMap||"function"==typeof k.Location&&e instanceof k.Location||"function"==typeof k.Storage&&e instanceof k.Storage||"function"==typeof k.WeakSet&&e instanceof k.WeakSet||"function"==typeof k.ArrayBuffer&&e instanceof k.ArrayBuffer||"function"==typeof k.Promise&&e instanceof k.Promise||"function"==typeof k.File&&e instanceof k.File||"function"==typeof k.Event&&e instanceof k.Event||"function"==typeof k.CustomEvent&&e instanceof k.CustomEvent||"function"==typeof k.Gamepad&&e instanceof k.Gamepad||"function"==typeof k.ResizeObserver&&e instanceof k.ResizeObserver||"function"==typeof k.MutationObserver&&e instanceof k.MutationObserver||"function"==typeof k.PerformanceObserver&&e instanceof k.PerformanceObserver||"function"==typeof k.IntersectionObserver&&e instanceof k.IntersectionObserver||"function"==typeof k.IDBCursor&&e instanceof k.IDBCursor||"function"==typeof k.IDBCursorWithValue&&e instanceof k.IDBCursorWithValue||"function"==typeof k.IDBDatabase&&e instanceof k.IDBDatabase||"function"==typeof k.IDBFactory&&e instanceof k.IDBFactory||"function"==typeof k.IDBIndex&&e instanceof k.IDBIndex||"function"==typeof k.IDBKeyRange&&e instanceof k.IDBKeyRange||"function"==typeof k.IDBObjectStore&&e instanceof k.IDBObjectStore||"function"==typeof k.IDBOpenDBRequest&&e instanceof k.IDBOpenDBRequest||"function"==typeof k.IDBRequest&&e instanceof k.IDBRequest||"function"==typeof k.IDBTransaction&&e instanceof k.IDBTransaction||"function"==typeof k.IDBVersionChangeEvent&&e instanceof k.IDBVersionChangeEvent||"function"==typeof k.FileSystemFileHandle&&e instanceof k.FileSystemFileHandle||"function"==typeof k.RTCPeerConnection&&e instanceof k.RTCPeerConnection||"function"==typeof k.ServiceWorkerRegistration&&e instanceof k.ServiceWorkerRegistration||"function"==typeof k.WebGLTexture&&e instanceof k.WebGLTexture;class R{static isBindable(e){return!!(e&&e[c]&&e[T])&&e[c]===R}static onDeck(e,t){return e[a].get(t)||!1}static ref(e){return e[s]||e||!1}static makeBindable(e){return this.make(e)}static shuck(e,t){t=t||new Map;var r=Object.create({});if(e instanceof S||e instanceof ArrayBuffer){var i=e.slice(0);return t.set(e,i),i}var s=Object.keys(e);for(var a in s){var o=s[a];if("___"!==o.substring(0,3)){var l=t.get(e[o]);if(l)r[o]=l;else if(e[o]!==e){if(e[o]&&"object"==typeof e[o]){var u=e[o];R.isBindable(e[o])&&(u=e[o][n]),r[o]=this.shuck(u,t)}else r[o]=e[o];t.set(e[o],r[o])}else t.set(e[o],r),r[o]=r}}return R.isBindable(e)&&(delete r.bindTo,delete r.isBound),r}static make(e){if(e[T])return e;if(!e||!["function","object"].includes(typeof e))return e;if(s in e)return e[s];if(e[c])return e;if(Object.isSealed(e)||Object.isFrozen(e)||!Object.isExtensible(e)||x(e))return e;Object.defineProperty(e,c,{configurable:!1,enumerable:!1,writable:!1,value:R}),Object.defineProperty(e,s,{configurable:!0,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(e,n,{configurable:!1,enumerable:!1,writable:!1,value:e}),Object.defineProperty(e,a,{configurable:!1,enumerable:!1,writable:!1,value:new Map}),Object.defineProperty(e,o,{configurable:!1,enumerable:!1,writable:!1,value:Object.create(null)}),Object.defineProperty(e,l,{configurable:!1,enumerable:!1,writable:!1,value:new Map}),Object.defineProperty(e,u,{configurable:!1,enumerable:!1,writable:!1,value:new Set}),Object.defineProperty(e,v,{enumerable:!1,writable:!0}),Object.defineProperty(e,h,{enumerable:!1,writable:!0}),Object.defineProperty(e,p,{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(e,E,{configurable:!1,enumerable:!1,writable:!1,value:new Set}),Object.defineProperty(e,P,{configurable:!1,enumerable:!1,writable:!1,value:new Set}),Object.defineProperty(e,f,{configurable:!1,enumerable:!1,writable:!1,value:Object.preventExtensions(new Map)}),Object.defineProperty(e,m,{configurable:!1,enumerable:!1,writable:!1,value:Object.preventExtensions(new Map)}),Object.defineProperty(e,j,{configurable:!1,enumerable:!1,writable:!1,value:Object.preventExtensions(new Map)});var t=(r,i=null,s={})=>{var n=!1;if(Array.isArray(r)){var a=r.map(e=>t(e,i,s));return()=>a.forEach(e=>e())}if(r instanceof Function&&(s=i||{},i=r,n=!0),s.delay>=0&&(i=this.wrapDelayCallback(i,s.delay)),s.throttle>=0&&(i=this.wrapThrottleCallback(i,s.throttle)),s.wait>=0&&(i=this.wrapWaitCallback(i,s.wait)),s.frame&&(i=this.wrapFrameCallback(i,s.frame)),s.idle&&(i=this.wrapIdleCallback(i)),n){if(e[u].add(i),!("now"in s)||s.now)for(var c in e)i(e[c],c,e,!1);return()=>{e[u].delete(i)}}if(e[o][r]||(e[o][r]=new Set),s.children){var h=i;i=((...t)=>{var r=t[0],i=e[l].get(h);if(i&&(e[l].delete(h),i()),"object"==typeof r){var n=R.make(r);R.isBindable(n)&&e[l].set(h,n.bindTo((...e)=>h(...t,...e),Object.assign({},s,{children:!1}))),h(...t)}else h(...t)})}e[o][r].add(i),"now"in s&&!s.now||i(e[r],r,e,!1);var d=()=>{var t=e[l].get(i);t&&(e[l].delete(i),t()),e[o][r]&&e[o][r].has(i)&&e[o][r].delete(i)};return s.removeWith&&s.removeWith instanceof View&&s.removeWith.onRemove(()=>d),d};Object.defineProperty(e,"bindTo",{configurable:!1,enumerable:!1,writable:!1,value:t});Object.defineProperty(e,w,{configurable:!1,enumerable:!1,writable:!1,value:(t,r)=>{var i=t.split("."),s=i.shift(),n=i.slice(0),a=[];return a.push(e.bindTo(s,(e,t,i,s)=>{var o=n.join(".");0!==n.length?(void 0===e&&(e=i[t]=this.make({})),a=a.concat(e[w](o,r))):r(e,t,i,s)})),()=>a.forEach(e=>e())}}),Object.defineProperty(e,"___before",{configurable:!1,enumerable:!1,writable:!1,value:t=>(e[E].add(t),()=>e[E].delete(t))}),Object.defineProperty(e,"___after",{configurable:!1,enumerable:!1,writable:!1,value:t=>(e[P].add(t),()=>e[P].delete(t))});for(var r in Object.defineProperty(e,"isBound",{configurable:!1,enumerable:!1,writable:!1,value:()=>{if(e[u].size)return!0;for(var t of Object.values(e[o]))if(t.size)return!0;return!1}}),e)e[r]&&"object"==typeof e[r]&&(e[r][s]||e[r]instanceof Promise||Object.isExtensible(e[r])&&!Object.isSealed(e[r])&&(x(e[r])||(e[r]=R.make(e[r]))));var i=e[j],M=e[f],A=e[p],B=Object.create(null);return B.set=((t,r,i)=>{if(i&&"object"==typeof i&&(i=R.make(i),t[r]===i))return!0;M.has(r)&&M.delete(r);var s=e[a],n=s.has(r),l=n&&s.get(r);if(n&&l===i)return!0;if(r.slice&&"___"===r.slice(-3))return!0;if(t[r]===i||"number"==typeof i&&isNaN(l)&&isNaN(i))return!0;for(var c of(s.set(r,i),e[u]))c(i,r,t,!1);if(r in e[o])for(var h of e[o][r])h(i,r,t,!1,t[r]);if(s.delete(r),k.File&&t instanceof k.File&&"lastModifiedDate"==r||Reflect.set(t,r,i),Array.isArray(t)&&e[o].length)for(var d in e[o].length)(0,e[o].length[d])(t.length,"length",t,!1,t.length);return!0}),B.construct=((t,r)=>{var i="constructor";for(var s of t[E])s(t,i,e[p],void 0,r);var a=R.make(new t[n](...r));for(var o of t[P])o(t,i,e[p],a,r);return a}),B.deleteProperty=((t,r)=>{var s=e[a];if(s.has(r))return!0;if(!(r in t))return!0;if(i.has(r)){var n=i.get(r);if(n&&!n.configurable)return!1;i.delete(r)}for(var l of(s.set(r,null),M.has(r)&&M.delete(r),e[u]))l(void 0,r,t,!0,t[r]);if(r in e[o])for(var c of e[o][r])c(void 0,r,t,!0,t[r]);return Reflect.deleteProperty(t,r),s.delete(r),!0}),e[_]||(B.getPrototypeOf=(t=>g in e?e[g]:Reflect.getPrototypeOf(t)),B.get=((t,r)=>{if(M.has(r))return M.get(r);if(r===s||r===n||"apply"===r||"isBound"===r||"bindTo"===r||"__proto__"===r||"constructor"===r)return e[r];var a;if(i.has(r)?a=i.get(r):(a=Object.getOwnPropertyDescriptor(e,r),i.set(r,a)),a&&!a.configurable&&!a.writable)return e[r];if(y in e)return e[y](r);if(b in e&&!(r in e))return e[b](r);if(a&&!a.configurable&&!a.writable)return M.set(r,e[r]),e[r];if("function"==typeof e[r]){if(d in e[r])return e[r];e[m].set(r,e[r]);var o=Object.getPrototypeOf(e)[r]===e[r],l=x(e)||"function"==typeof e[Symbol.iterator]&&"next"===r||"function"==typeof S&&e instanceof S||"function"==typeof EventTarget&&e instanceof EventTarget||"function"==typeof Date&&e instanceof Date||"function"==typeof C&&e.prototype===C||"function"==typeof O&&e.prototype===O?e:e[s],u=function(...t){for(var i of(e[v]=r,A.unshift(r),e[E]))i(e,r,A,e,t);var s;if(new.target)s=new(e[m].get(r))(...t);else{var n=e[m].get(r);s=o?n.apply(l||e,t):n(...t)}for(var a of e[P])a(e,r,A,e,t);return e[v]=null,A.shift(),s};u[y]=(t=>e[r][t]);var c=R.make(u);return M.set(r,c),c}return e[r]})),Object.defineProperty(e,s,{configurable:!1,enumerable:!1,writable:!1,value:new Proxy(e,B)}),e[s]}static clearBindings(e){var t=(e=>(...t)=>t.map(e))(e=>Object.keys(e).map(t=>delete e[t]));e[u].clear(),t(e[f],e[o],e[P],e[E])}static resolve(e,t,r=!1){for(var i,s=t.split("."),n=s[0];s.length;){if(r&&1===s.length)return[this.make(e),s.shift(),n];(i=s.shift())in e&&e[i]&&"object"==typeof e[i]||(e[i]=Object.create(null)),e=this.make(e[i])}return[this.make(e),i,n]}static wrapDelayCallback(e,t){return(...r)=>setTimeout(()=>e(...r),t)}static wrapThrottleCallback(e,t){return this.throttles.set(e,!1),(...r)=>{this.throttles.get(e,!0)||(e(...r),this.throttles.set(e,!0),setTimeout(()=>{this.throttles.set(e,!1)},t))}}static wrapWaitCallback(e,t){return(...r)=>{var i;(i=this.waiters.get(e))&&(this.waiters.delete(e),clearTimeout(i)),i=setTimeout(()=>e(...r),t),this.waiters.set(e,i)}}static wrapFrameCallback(e,t){return(...t)=>{requestAnimationFrame(()=>e(...t))}}static wrapIdleCallback(e){return(...t)=>{(window.requestIdleCallback||requestAnimationFrame)(()=>e(...t))}}}e.Bindable=R,i(R,"waiters",new WeakMap),i(R,"throttles",new WeakMap),Object.defineProperty(R,"Prevent",{configurable:!1,enumerable:!1,writable:!1,value:T}),Object.defineProperty(R,"OnGet",{configurable:!1,enumerable:!1,writable:!1,value:b}),Object.defineProperty(R,"NoGetters",{configurable:!1,enumerable:!1,writable:!1,value:_}),Object.defineProperty(R,"GetProto",{configurable:!1,enumerable:!1,writable:!1,value:g}),Object.defineProperty(R,"OnAllGet",{configurable:!1,enumerable:!1,writable:!1,value:y})}),require.register("curvature/base/Cache.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Cache=void 0;e.Cache=class{static store(e,t,r,i="standard"){var s=0;r&&(s=1e3*r+(new Date).getTime()),this.buckets||(this.buckets=new Map),this.buckets.has(i)||this.buckets.set(i,new Map);var n=new CustomEvent("cvCacheStore",{cancelable:!0,detail:{key:e,value:t,expiry:r,bucket:i}});document.dispatchEvent(n)&&this.buckets.get(i).set(e,{value:t,expiration:s})}static load(e,t=!1,r="standard"){var i=new CustomEvent("cvCacheLoad",{cancelable:!0,detail:{key:e,defaultvalue:t,bucket:r}});if(!document.dispatchEvent(i))return t;if(this.buckets&&this.buckets.has(r)&&this.buckets.get(r).has(e)){var s=this.buckets.get(r).get(e);if(0===s.expiration||s.expiration>(new Date).getTime())return this.buckets.get(r).get(e).value}return t}}}),require.register("curvature/base/Config.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Config=void 0;var i={},s=t,n="object"==typeof globalThis?globalThis:"object"==typeof window?window:"object"==typeof self?self:void 0;try{i=s("/Config").Config}catch(e){!0===n.devMode&&console.error(e),i={}}class a{static get(e){return this.configs[e]}static set(e,t){return this.configs[e]=t,this}static dump(){return this.configs}static init(...e){for(var t in e){var r=e[t];for(var i in"string"==typeof r&&(r=JSON.parse(r)),r){var s=r[i];return this.configs[i]=s}}return this}}e.Config=a,Object.defineProperty(a,"configs",{configurable:!1,enumerable:!1,writable:!1,value:i})}),require.register("curvature/base/Cookie.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Cookie=void 0;var i,s,n,a=t("./Bindable");class o{static set(e,t){this.jar[e]=t}static get(e){return this.jar[e]}static delete(e){delete this.jar[e]}}e.Cookie=o,i=o,s="jar",n=a.Bindable.make({}),(s=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(s))in i?Object.defineProperty(i,s,{value:n,enumerable:!0,configurable:!0,writable:!0}):i[s]=n,"string"==typeof document.cookie&&"data"!==window.location.href.substr(0,4)&&(document.cookie.split(";").map(e=>{var[t,r]=e.split("=");try{r=JSON.parse(r)}catch(e){r=r}t=t.trim(),o.jar[decodeURIComponent(t)]=r}),o.jar.bindTo((e,t,r,i)=>{document.cookie=i?`${encodeURIComponent(t)}=;expires=${new Date(0)}`:`${encodeURIComponent(t)}=${e}`}))}),require.register("curvature/base/Dom.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Dom=void 0;e.Dom=class{static mapTags(e,t,r,i,s){var n=[],a=!0;i&&(a=!1);var o=!1,{Node:l,Element:u,NodeFilter:c,document:h}=globalThis.window,d=h.createTreeWalker(e,c.SHOW_ELEMENT|c.SHOW_TEXT,{acceptNode:(e,r)=>{if(!a){if(e!==i)return c.FILTER_SKIP;a=!0}return s&&e===s&&(o=!0),o?c.FILTER_SKIP:t?e instanceof u&&e.matches(t)?c.FILTER_ACCEPT:c.FILTER_SKIP:c.FILTER_ACCEPT}},!1);for(0;d.nextNode();)n.push(r(d.currentNode,d));return n}static dispatchEvent(e,t){e.dispatchEvent(t),this.mapTags(e,!1,e=>{e.dispatchEvent(t)})}}}),require.register("curvature/base/Import.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Import=void 0;class i{constructor(e){if(console.log(this.__proto__.constructor),this.__proto__.constructor.instances[e])return this.__proto__.constructor.instances[e];this.uri=e;var t=document.createElement("script");t.setAttribute("src",this.uri),this.ready=new Promise((e,r)=>{t.addEventListener("load",r=>e(t)),t.addEventListener("error",e=>{console.error(e),r(e)})}),this.tag=t,this.attached=!1,this.__proto__.constructor.instances[e]=this}attach(e=null){this.attached||((e=e||document.head).append(this.tag),this.attached=!0)}}e.Import=i,i.instances={}}),require.register("curvature/base/Mixin.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Mixin=void 0;var i=t("./Bindable"),s=Symbol("constructor");Symbol("mixinList");class n{static from(e,...t){var r=class extends e{constructor(...i){var s=e.constructor?super(...i):null;for(var a of t)switch(a[n.Constructor]&&a[n.Constructor].apply(this),typeof a){case"function":n.mixClass(a,r);break;case"object":n.mixObject(a,this)}return s}};return r}static make(...e){var t=e.pop();return n.to(t,...e)}static to(e,...t){var r={};t.map(t=>{switch(typeof t){case"object":Object.assign(r,Object.getOwnPropertyDescriptors(t));break;case"function":Object.assign(r,Object.getOwnPropertyDescriptors(t.prototype))}delete r.constructor,Object.defineProperties(e.prototype,r)})}static with(...e){return this.from(class{constructor(){}},...e)}static mixObject(e,t){for(var r of Object.getOwnPropertyNames(e))"function"!=typeof e[r]?t[r]=e[r]:t[r]=e[r].bind(t);for(var i of Object.getOwnPropertySymbols(e))"function"!=typeof e[i]?t[i]=e[i]:t[i]=e[i].bind(t)}static mixClass(e,t){for(var r of Object.getOwnPropertyNames(e.prototype))if(!["name","prototype","length"].includes(r)){var i=Object.getOwnPropertyDescriptor(t,r);i&&!i.writable||("function"==typeof e[r]?t.prototype[r]=e.prototype[r].bind(t.prototype):t.prototype[r]=e.prototype[r])}for(var s of Object.getOwnPropertySymbols(e.prototype))"function"==typeof e[s]?t.prototype[s]=e.prototype[s].bind(t.prototype):t.prototype[s]=e.prototype[s];var n=function(){if(["name","prototype","length"].includes(a))return 0;var r=Object.getOwnPropertyDescriptor(t,a);if(r&&!r.writable)return 0;if("function"!=typeof e[a])return t[a]=e[a],0;var i=t[a]||!1,s=e[a].bind(t);t[a]=((...e)=>(i&&i(...e),s(...e)))};for(var a of Object.getOwnPropertyNames(e))n();var o=function(){if("function"!=typeof e[l])return t.prototype[l]=e[l],1;var r=t[l]||!1,i=e[l].bind(t);t[l]=((...e)=>(r&&r(...e),i(...e)))};for(var l of Object.getOwnPropertySymbols(e))o()}static mix(e){for(var t={},r={},s=i.Bindable.makeBindable(e),n=function(e){var i=Object.getOwnPropertyNames(e.prototype),n=Object.getOwnPropertyNames(e),a=/^(before|after)__(.+)/,o=function(r){var i=r.match(a);if(i){switch(i[1]){case"before":s.___before((t,s,n,a,o)=>{if(s===i[2])return e[r].bind(a)(...o)});break;case"after":s.___after((t,s,n,a,o)=>{if(s===i[2])return e[r].bind(a)(...o)})}return 0}return t[r]?0:"function"!=typeof e[r]?0:void(t[r]=e[r])};for(var l of n)o(l);var u=function(t){var i=t.match(a);if(i){switch(i[1]){case"before":s.___before((r,s,n,a,o)=>{if(s===i[2])return e.prototype[t].bind(a)(...o)});break;case"after":s.___after((r,s,n,a,o)=>{if(s===i[2])return e.prototype[t].bind(a)(...o)})}return 0}return r[t]?0:"function"!=typeof e.prototype[t]?0:void(r[t]=e.prototype[t])};for(var c of i)u(c)},a=this;a&&a.prototype;a=Object.getPrototypeOf(a))n(a);for(var o in t)e[o]=t[o].bind(e);var l=function(t){e.prototype[t]=function(...e){return r[t].apply(this,e)}};for(var u in r)l(u);return s}}e.Mixin=n,n.Constructor=s}),require.register("curvature/base/Model.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Model=void 0;var i=t("./Cache"),s=t("./Bindable");t("./Repository");class n{constructor(e){this.repository=e}consume(e){for(var t in e){var r=e[t];if(e[t]instanceof Object&&e[t].class&&e[t].publicId){var a=`${e[t].class}::${e[t].publidId}`,o=i.Cache.load(a,!1,"model-type-repo");r=s.Bindable.makeBindable(new n(this.repository)),o&&(r=o),r.consume(e[t]),i.Cache.store(a,r,0,"model-type-repo")}this[t]=r}}}e.Model=n}),require.register("curvature/base/Pool.js",function(e,t,r){"use strict";function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(e,"__esModule",{value:!0}),e.Pool=void 0;e.Pool=class{constructor({max:e,init:t}){i(this,"backlog",[]),i(this,"running",new Set),i(this,"max",1),i(this,"init",e=>new Promise(e)),this.init=t||this.init,this.max=e||this.max}add(e){var t=()=>{if(this.running.delete(e),this.backlog.length){var r=this.backlog.shift();this.init(r).finally(t),this.running.add(r)}};this.running.size<this.max?(this.init(e).finally(t),this.running.add(e)):this.backlog.push(e)}}}),require.register("curvature/base/Repository.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Repository=void 0;var i=t("./Bindable"),s=t("./Router"),n=t("./Cache"),a=t("./Model"),o=t("./Bag"),l=t("../form/Form"),u=t("../form/multiField/FormWrapper");class c{constructor(e){this.uri=e}get(e,t=!1,r={}){var i=this.uri+"/"+e,a=n.Cache.load(i+s.Router.queryToString(s.Router.queryOver(r),!0),!1,"model-uri-repo");return!t&&a?Promise.resolve(a):c.request(i,r).then(e=>this.extractModel(e.body))}page(e=0,t){return c.request(this.uri,t).then(e=>{var t=[];for(var r in e.body){var i=e.body[r];t.push(this.extractModel(i))}return e.body=t,e})}edit(e=null,t=null,r={}){var i=this.uri+"/create";return e&&(i=this.uri+"/"+e+"/edit"),t?c.request(i,{api:"json"},t).then(e=>e.body):c.request(i).then(e=>{var t=new l.Form(e.meta.form,r);return new u.FormWrapper(t,i,"POST",r)})}extractModel(e){var t=i.Bindable.makeBindable(new a.Model(this));t.consume(e);this.uri,t.publicId;if(t.class){var r=`${t.class}::${t.publidId}`;n.Cache.load(r,!1,"model-type-repo")}return t}static loadPage(e={},t=!1){return this.request(this.uri,e).then(e=>e)}static domCache(e,t){}static load(e,t=!1){return this.objects=this.objects||{},this.objects[this.uri]=this.objects[this.uri]||{},this.objects[this.uri][e]?Promise.resolve(this.objects[this.uri][e]):this.request(this.uri+"/"+e).then(e=>{})}static form(e=null){var t=this.uri+"/create";return e&&(t=this.uri+"/"+e+"/edit"),this.request(t).then(e=>e)}static clearCache(){this.objects&&this.objects[this.uri]&&(this.objects[this.uri]={})}static encode(e,t=null,r=null){for(var i in r||(r=new FormData),e){var s=i;t&&(s=`${t}[${s}]`),e[i]&&"object"!=typeof e[i]?r.append(s,e[i]):this.encode(e[i],s,r)}return r}static onResponse(e){return this._onResponse||(this._onResponse=new o.Bag),this._onResponse.add(e)}static request(e,t=null,r=null,i=!0,s={}){var n,a="GET",l=null,u={};t&&(u=t),this._onResponse||(this._onResponse=new o.Bag),this.runningRequests||(this.runningRequests={}),u.api=u.api||"json",n=Object.keys(u).map(e=>encodeURIComponent(e)+"="+encodeURIComponent(u[e])).join("&");var c;if(c=e+"?"+n,!r&&this.runningRequests[c])return this.runningRequests[c];r&&(i=!1,a="POST",l=r instanceof FormData?r:this.encode(r));var h=new XMLHttpRequest;if("responseType"in s&&(h.responseType=s.responseType),!r&&i&&this.cache&&this.cache[c])return Promise.resolve(this.cache[c]);var d='script[data-uri="'+c+'"]',v=document.querySelector(d);if(!r&&i&&v){var p=JSON.parse(v.innerText);return Promise.resolve(p)}h.withCredentials=!("withCredentials"in s)||s.withCredentials,document.createElement("a").href=c,r||(h.timeout=s.timeout||15e3,this.xhrs[c]=h);var f=new Promise((e,t)=>{if(r&&"progressUp"in s&&(h.upload.onprogress=s.progressUp),"progressDown"in s&&(h.onprogress=s.progressDown),h.onreadystatechange=(()=>{var r;if(4===h.readyState)if(delete this.xhrs[c],delete this.runningRequests[c],this.cache||(this.cache={}),"application/json"==h.getResponseHeader("Content-Type")||"application/json; charset=utf-8"==h.getResponseHeader("Content-Type")||"text/json"==h.getResponseHeader("Content-Type")||"text/json; charset=utf-8"==h.getResponseHeader("Content-Type"))if((r=JSON.parse(h.responseText))&&0==r.code){var i=document.querySelector('script[data-uri="'+c+'"]');(window.prerenderer||navigator.userAgent.match(/prerender/i))&&(window.prerenderer=window.prerenderer||!0,i||((i=document.createElement("script")).type="text/json",i.setAttribute("data-hack","application/ld+json-NOT!"),i.setAttribute("data-uri",c),document.head.appendChild(i)),i.innerText=JSON.stringify(r));var s=this._onResponse.items();for(var n in s)s[n](r,!0);r._http=h.status,200===h.status?e(r):t(r)}else{var a=this._onResponse.items();for(var o in a)a[o](r,!0);t(r)}else{var l=this._onResponse.items();for(var u in l)l[u](h,!0);200===h.status?e(h):t(h)}}),h.open(a,c,!0),s.headers)for(var i in s.headers)h.setRequestHeader(i,s.headers[i]);h.send(l)});return r||(this.runningRequests[c]=f),f}static cancel(e=/^.$/){for(var t in this.xhrs)this.xhrs[t]&&t.match(e)&&(this.xhrs[t].abort(),delete this.xhrs[t])}}e.Repository=c,c.xhrs=[]}),require.register("curvature/base/Router.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Router=void 0;var i=t("./View"),s=(t("./Cache"),t("./Config")),n=t("./Routes"),a=Symbol("NotFound"),o=Symbol("Internal"),l="object"==typeof globalThis?globalThis:"object"==typeof window?window:"object"==typeof self?self:void 0;l.CustomEvent=l.CustomEvent||l.Event;class u{static wait(e,t="DOMContentLoaded",r=document){r.addEventListener(t,()=>{this.listen(e)})}static listen(e,t=!1){this.listener=e||this.listener,this.routes=t||e.routes,Object.assign(this.query,this.queryOver({}));var r=t=>{t.preventDefault(),t.state&&"routedId"in t.state?(t.state.routedId<=this.routeCount?(this.history.splice(t.state.routedId),this.routeCount=t.state.routedId):t.state.routedId>this.routeCount&&(this.history.push(t.state.prev),this.routeCount=t.state.routedId),this.state=t.state):null!==this.prevPath&&this.prevPath!==location.pathname&&this.history.push(this.prevPath),this.isOriginLimited(location)?this.match(this.nextPath,e):this.match(location.pathname,e)};window.addEventListener("cvUrlChanged",r),window.addEventListener("popstate",r);var i=!this.isOriginLimited(location)&&location.pathname+location.search;!this.isOriginLimited(location)&&location.hash&&(i+=location.hash);var s={routedId:this.routeCount,url:location.pathname,prev:this.prevPath};this.isOriginLimited(location)||history.replaceState(s,null,location.pathname),this.go(!1!==i?i:"/")}static go(e,t=!1){var r=s.Config.get("title");r&&(document.title=r);var i={routedId:this.routeCount,prev:this.prevPath,url:location.pathname};-1===t?this.match(e,this.listener,!0):this.isOriginLimited(location)?this.nextPath=e:2===t&&location.pathname!==e?history.replaceState(i,null,e):location.pathname!==e&&history.pushState(i,null,e),(!t||t<0)&&(!1===t&&(this.path=null),t||("#"===e.substring(0,1)?window.dispatchEvent(new HashChangeEvent("hashchange")):window.dispatchEvent(new CustomEvent("cvUrlChanged")))),this.prevPath=e}static processRoute(e,t,r){return"function"==typeof e[t]?e[t].prototype instanceof i.View?new e[t](r):e[t](r):e[t]}static handleError(e,t,r,i,s,n,a,u){"undefined"!=typeof document&&document.dispatchEvent(new CustomEvent("cvRouteError",{detail:{error:e,path:n,prev:a,view:s,routes:t,selected:r}}));var c=l.devMode?"Unexpected error: "+String(e):"Unexpected error.";t[o]&&(i[o]=e,c=this.processRoute(t,o,i)),this.update(s,n,c,t,r,i,u)}static match(e,t,r=!1){var i=null,s=!1;if(!0===r&&(s=r),r&&"object"==typeof r&&(s=r.forceRefresh,i=r.event),"undefined"==typeof document||this.path!==e||s){var o="http://example.com";"undefined"!=typeof document&&(o=this.isOriginLimited(location)?o:location.origin,this.queryString=location.search);var l=new URL(e,o);e=this.path=l.pathname,"undefined"==typeof document&&(this.queryString=l.search);var u=this.prevPath,c=t&&t.args?t.args.content:null,h=this.routes||t&&t.routes||n.Routes.dump(),d=new URLSearchParams(this.queryString);for(var v in i&&i.request&&(this.request=i.request),Object.keys(this.query))delete this.query[v];for(var[p,f]of d)this.query[p]=f;var m={},g=!1,b="";for(var y in"/"===e.substring(0,1)&&(e=e.substring(1)),e=e.split("/"),this.query)m[y]=this.query[y];e:for(var w in h){var j=w.split("/");if(!(j.length<e.length&&"*"!==j[j.length-1])){for(var E in j)if("%"==j[E].substr(0,1)){var P=null,_=/^%(\w+)\??/.exec(j[E]);if(_&&_[1]&&(P=_[1]),!P)throw new Error(`${j[E]} is not a valid argument segment in route "${w}"`);if(e[E])m[P]=e[E];else{if("?"!=j[E].substr(j[E].length-1,1))continue e;m[P]=""}}else if("*"!==j[E]&&e[E]!==j[E])continue e;g=w,b=h[w],"*"===j[j.length-1]&&(m.pathparts=e.slice(j.length-1));break}}var T=new CustomEvent("cvRouteStart",{cancelable:!0,detail:{path:e,prev:u,root:t,selected:g,routes:h}});if("undefined"==typeof document||document.dispatchEvent(T)){if(!s&&t&&c&&"object"==typeof b&&c.constructor===b.constructor&&!(b instanceof Promise)&&c.update(m))return t.args.content=c,!0;g in h||(h[g]=h[a]);try{return!1===(b=this.processRoute(h,g,m))&&(b=this.processRoute(h,a,m)),"undefined"==typeof document?b instanceof Promise?b:Promise.resolve(b):b instanceof Promise?b.then(r=>this.update(t,e,r,h,g,m,s)).catch(r=>{this.handleError(r,h,g,m,t,e,u,s)}):this.update(t,e,b,h,g,m,s)}catch(r){this.handleError(r,h,g,m,t,e,u,s)}}}}static update(e,t,r,s,n,a,o){if(e){var l=this.prevPath,u=new CustomEvent("cvRoute",{cancelable:!0,detail:{result:r,path:t,prev:l,view:e,routes:s,selected:n}});!1!==r&&(e.args.content instanceof i.View&&(e.args.content.pause(!0),e.args.content.remove()),document.dispatchEvent(u)&&(e.args.content=r),r instanceof i.View&&(r.pause(!1),r.update(a,o)));var c=new CustomEvent("cvRouteEnd",{cancelable:!0,detail:{result:r,path:t,prev:l,view:e,routes:s,selected:n}});document.dispatchEvent(c)}}static isOriginLimited({origin:e}){return"null"===e||"file://"===e}static queryOver(e={}){var t=new URLSearchParams(location.search),r={},i={};for(var s of t)i[s[0]]=s[1];return delete(r=Object.assign(r,i,e)).api,r}static queryToString(e={},t=!1){var r=[],i=e;for(var s in t||(i=this.queryOver(e)),i)""!==i[s]&&r.push(s+"="+encodeURIComponent(i[s]));return r.join("&")}static setQuery(e,t,r){var i=this.queryOver();i[e]=t,void 0===t&&delete i[e];var s=this.queryToString(i,!0);this.go(location.pathname+(s?"?"+s:"?"),r)}}e.Router=u,Object.defineProperty(u,"query",{configurable:!1,enumerable:!1,writable:!1,value:{}}),Object.defineProperty(u,"history",{configurable:!1,enumerable:!1,writable:!1,value:[]}),Object.defineProperty(u,"routeCount",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(u,"prevPath",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(u,"queryString",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(u,"InternalError",{configurable:!1,enumerable:!1,writable:!1,value:o}),Object.defineProperty(u,"NotFoundError",{configurable:!1,enumerable:!1,writable:!1,value:a})}),require.register("curvature/base/Routes.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Routes=void 0;var i={},s=t,n=!1,a=()=>{if(!n){try{Object.assign(i,s("Routes").Routes||{})}catch(e){!0===globalThis.devMode&&console.warn(e)}n=!0}};class o{static get(e){return a(),this.routes[e]}static dump(){return a(),this.routes}}e.Routes=o,Object.defineProperty(o,"routes",{configurable:!1,enumerable:!1,writable:!1,value:i})}),require.register("curvature/base/RuleSet.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RuleSet=void 0;t("./Dom");var i=t("./Tag"),s=t("./View");class n{static add(e,t){return this.globalRules=this.globalRules||{},this.globalRules[e]=this.globalRules[e]||[],this.globalRules[e].push(t),this}static apply(e=document,t=null){for(var r in this.globalRules)for(var i in this.globalRules[r]){var s=this.globalRules[r][i],n=this.wrap(e,s,t),a=e.querySelectorAll(r);for(var o of a)n(o)}}add(e,t){return this.rules=this.rules||{},this.rules[e]=this.rules[e]||[],this.rules[e].push(t),this}apply(e=document,t=null){for(var r in n.apply(e,t),this.rules)for(var i in this.rules[r]){var s=this.rules[r][i],a=n.wrap(e,s,t),o=e.querySelectorAll(r);for(var l of o)a(l)}}purge(){if(this.rules)for(var[e,t]of Object.entries(this.rules))if(this.rules[e])for(var r in this.rules[e])delete this.rules[e][r]}static wait(e="DOMContentLoaded",t=document){var r=((e,t)=>()=>(t.removeEventListener(e,r),this.apply()))(e,t);t.addEventListener(e,r)}static wrap(e,t,r=null){var n=t;return(t instanceof s.View||t&&t.prototype&&t.prototype instanceof s.View)&&(n=(()=>t)),e=>{if(void 0===e.___cvApplied___&&Object.defineProperty(e,"___cvApplied___",{enumerable:!1,writable:!1,value:new WeakSet}),!e.___cvApplied___.has(t)){var a,o;r&&(a=o=r,r.viewList&&(o=r.viewList.parent));var l=new i.Tag(e,o,null,void 0,a),u=l.element.parentNode,c=l.element.nextSibling,h=n(l);if(!1!==h&&e.___cvApplied___.add(t),h instanceof HTMLElement&&(h=new i.Tag(h)),h instanceof i.Tag){if(!h.element.contains(l.element)){for(;l.element.firstChild;)h.element.appendChild(l.element.firstChild);l.remove()}c?u.insertBefore(h.element,c):u.appendChild(h.element)}h&&h.prototype&&h.prototype instanceof s.View&&(h=new h({},r)),h instanceof s.View&&(r&&(r.cleanup.push(()=>h.remove()),r.cleanup.push(r.args.bindTo((e,t,r)=>{r[t]=e,h.args[t]=e})),r.cleanup.push(h.args.bindTo((e,t,i,s)=>{i[t]=e,r.args[t]=e}))),l.clear(),h.render(l.element))}}}}e.RuleSet=n}),require.register("curvature/base/SetMap.js",function(e,t,r){"use strict";function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(e,"__esModule",{value:!0}),e.SetMap=void 0;e.SetMap=class{constructor(){i(this,"_map",new Map)}has(e){return this._map.has(e)}get(e){return this._map.get(e)}getOne(e){var t=this.get(e);for(var r of t)return r}add(e,t){var r=this._map.get(e);return r||this._map.set(e,r=new Set),r.add(t)}remove(e,t){var r=this._map.get(e);if(r){var i=r.delete(t);return r.size||this._map.delete(e),i}}values(){return new Set(...[...this._map.values()].map(e=>[...e.values()]))}}}),require.register("curvature/base/Tag.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Tag=void 0;var i=t("./Bindable"),s=Symbol("CurrentStyle"),n=function(e){if(this.node)for(var t in e){var r=String(e[t]);this[s].has(t)&&this[s].get(t)===e[t]||Number.isNaN(e[t])||("-"===t[0]?this.node.style.setProperty(t,r):this.node.style[t]=r,void 0!==e[t]?this[s].set(t,e[t]):this[s].delete(t))}},a=function(e){return"function"==typeof this[e]?this[e]:this.node&&"function"==typeof this.node[e]?this[e]=((...t)=>this.node[e](...t)):"style"===e?this.proxy.style:this.node&&e in this.node?this.node[e]:this[e]};e.Tag=class{constructor(e,t,r,o,l){if("string"==typeof e){var u=document.createRange().createContextualFragment(e);e=u.firstChild}this.element=i.Bindable.makeBindable(e),this.node=this.element,this.parent=t,this.direct=l,this.ref=r,this.index=o,this.cleanup=[],this[i.Bindable.OnAllGet]=a.bind(this),this[s]=new Map;var c=i.Bindable.make(n.bind(this));return Object.defineProperty(this,"style",{value:c}),this.proxy=i.Bindable.make(this),this.proxy.style.bindTo((e,t,r,i)=>{this[s].has(t)&&this[s].get(t)===e||(this.node.style[t]=e,i||void 0===e?this[s].delete(t):this[s].set(t,e))}),this.proxy.bindTo((t,r)=>{if("index"!==r)return r in e&&e[r]!==t&&(e[r]=t),!1}),this.proxy}attr(e){for(var t in e)void 0===e[t]?this.node.removeAttribute(t):null===e[t]?this.node.setAttribute(t,""):this.node.setAttribute(t,e[t]);return this}remove(){var e;for(this.node&&this.node.remove(),i.Bindable.clearBindings(this);e=this.cleanup.shift();)e();if(this.clear(),this.node){var t=new Event("cvDomDetached");this.node.dispatchEvent(t),this.node=this.element=this.ref=this.parent=void 0}}clear(){if(this.node)for(var e=new Event("cvDomDetached");this.node.firstChild;)this.node.firstChild.dispatchEvent(e),this.node.removeChild(this.node.firstChild)}pause(e=!0){}listen(e,t,r){var i=this.node;i.addEventListener(e,t,r);var s=()=>{i.removeEventListener(e,t,r)},n=()=>{s(),s=(()=>console.warn("Already removed!"))};return this.parent.onRemove(()=>n()),n}}}),require.register("curvature/base/Theme.js",function(e,t,r){"use strict";function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(e,"__esModule",{value:!0}),e.Theme=void 0;class s{constructor(e){i(this,"themes",[]),this.themes.push(...e)}getTemplate(e){for(var t in this.themes){var r=this.themes[t].getTemplate(e);if(r)return r}}getView(e){for(var t in this.themes){var r=this.themes[t].getView(e);if(r)return r}}}class n{static get(...e){if(e.length<=1){var t=String(e[0]||"");return this.instances[t]||(this.instances[t]=new this(t)),this.instances[t]}var r=[];for(var i in e)r.push(this.get(e[i]));return new s(r)}constructor(e){this.key=e,this.viewMap=new Map,this.templateMap=new Map,this.fallbacks=[]}setFallback(...e){return this.fallbacks.push(...e),this}setView(e,t){return this.viewMap.set(e,t),this}getView(e){var t=this.resolve(e,"viewMap");return t?new t(e):null}setTemplate(e,t){return this.templateMap.set(e,t),this}getTemplate(e){return this.resolve(e,"templateMap")}resolve(e,t){e.___object___&&e.isBound&&(e=e.___object___);var r=e.__proto__.constructor,i=this[t];if(i.has(r,e))return i.get(r);var s=null;for(var[n,a]of i)e instanceof n&&(s=a);if(!s)for(var o of this.fallbacks)if(s=o.resolve(e,t))return s;return s&&i.set(r,s),s}}e.Theme=n,i(n,"instances",{})}),require.register("curvature/base/Uuid.js",function(e,t,r){"use strict";function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(e,"__esModule",{value:!0}),e.Uuid=void 0;var s=("object"==typeof globalThis?globalThis:"object"==typeof window?window:"object"==typeof self?self:void 0).crypto;class n{constructor(e=null,t=4){if(i(this,"uuid",null),i(this,"version",4),e){if("string"!=typeof e&&!(e instanceof n)||!e.match(/[0-9A-Fa-f]{8}(-[0-9A-Fa-f]{4}){3}-[0-9A-Fa-f]{12}/))throw new Error(`Invalid input for Uuid: "${e}"`);this.version=t,this.uuid=e}else if(s&&"function"==typeof s.randomUUID)this.uuid=s.randomUUID();else{var r=s&&"function"==typeof s.randomUUID?()=>s.getRandomValues(new Uint8Array(1))[0]:()=>Math.trunc(256*Math.random());this.uuid=([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^r()&15>>e/4).toString(16))}Object.freeze(this)}[Symbol.toPrimitive](){return this.toString()}toString(){return this.uuid}toJson(){return{version:this.version,uuid:this.uuid}}}e.Uuid=n}),require.register("curvature/base/View.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.View=void 0;var i=t("./Bindable"),s=t("./ViewList"),n=t("./Router"),a=t("./Uuid"),o=t("./Dom"),l=t("./Tag"),u=t("./Bag"),c=t("./RuleSet"),h=t("./Mixin"),d=t("../mixin/EventTargetMixin"),v=Symbol("dontParse"),p=Symbol("expandBind"),f=Symbol("uuid");class m extends(h.Mixin.with(d.EventTargetMixin)){get _id(){return this[f]}static from(e,t={},r=null){var i=new this(t,r);return i.template=e,i}constructor(e={},t=null){super(e,t),this[d.EventTargetMixin.Parent]=t,Object.defineProperty(this,"args",{value:i.Bindable.make(e)}),Object.defineProperty(this,f,{value:this.constructor.uuid()}),Object.defineProperty(this,"nodesAttached",{value:new u.Bag((e,t,r)=>{})}),Object.defineProperty(this,"nodesDetached",{value:new u.Bag((e,t,r)=>{})}),Object.defineProperty(this,"_onRemove",{value:new u.Bag((e,t,r)=>{})}),Object.defineProperty(this,"cleanup",{value:[]}),Object.defineProperty(this,"parent",{value:t,writable:!0}),Object.defineProperty(this,"views",{value:new Map}),Object.defineProperty(this,"viewLists",{value:new Map}),Object.defineProperty(this,"withViews",{value:new Map}),Object.defineProperty(this,"tags",{value:i.Bindable.make({})}),Object.defineProperty(this,"nodes",{value:i.Bindable.make([])}),Object.defineProperty(this,"timeouts",{value:new Map}),Object.defineProperty(this,"intervals",{value:new Map}),Object.defineProperty(this,"frames",{value:[]}),Object.defineProperty(this,"ruleSet",{value:new c.RuleSet}),Object.defineProperty(this,"preRuleSet",{value:new c.RuleSet}),Object.defineProperty(this,"subBindings",{value:{}}),Object.defineProperty(this,"templates",{value:{}}),Object.defineProperty(this,"postMapping",{value:new Set}),Object.defineProperty(this,"eventCleanup",{value:[]}),Object.defineProperty(this,"unpauseCallbacks",{value:new Map}),Object.defineProperty(this,"interpolateRegex",{value:/(\[\[((?:\$+)?[\w\.\|-]+)\]\])/g}),Object.defineProperty(this,"rendered",{value:new Promise((e,t)=>Object.defineProperty(this,"renderComplete",{value:e}))}),this.onRemove(()=>{this[d.EventTargetMixin.Parent]&&(this[d.EventTargetMixin.Parent]=null)}),this.controller=this,this.template="",this.firstNode=null,this.lastNode=null,this.viewList=null,this.mainView=null,this.preserve=!1,this.removed=!1,this.loaded=Promise.resolve(this)}static isView(){return m}onFrame(e){var t=!1,r=()=>{t=!0},i=r=>{this.removed||t||(this.paused||e(Date.now()),requestAnimationFrame(i))};return requestAnimationFrame(()=>i(Date.now())),this.frames.push(r),r}onNextFrame(e){return requestAnimationFrame(()=>e(Date.now()))}onIdle(e){return requestIdleCallback(()=>e(Date.now()))}onTimeout(e,t){var r={timeout:null,callback:null,time:e,fired:!1,created:(new Date).getTime(),paused:!1},i=()=>{t(),r.fired=!0,this.timeouts.delete(r.timeout)},s=setTimeout(i,e);return r.callback=i,r.timeout=s,this.timeouts.set(r.timeout,r),s}clearTimeout(e){if(this.timeouts.has(e)){var t=this.timeouts.get(e);clearTimeout(t.timeout),this.timeouts.delete(t.timeout)}}onInterval(e,t){var r=setInterval(t,e);return this.intervals.set(r,{timeout:r,callback:t,time:e,paused:!1}),r}clearInterval(e){if(this.intervals.has(e)){var t=this.intervals.get(e);clearTimeout(t.timeout),this.intervals.delete(t.timeout)}}pause(e){if(void 0===e&&(this.paused=!this.paused),this.paused=e,this.paused){for(var[t,r]of this.timeouts)r.fired?this.timeouts.delete(r.timeout):(clearTimeout(r.timeout),r.paused=!0,r.time=Math.max(0,r.time-(Date.now()-r.created)));for(var[i,s]of this.intervals)clearInterval(s.timeout),s.paused=!0}else{for(var[n,a]of this.timeouts)a.paused&&(a.fired?this.timeouts.delete(a.timeout):(a.timeout=setTimeout(a.callback,a.time),a.paused=!1));for(var[o,l]of this.intervals)l.paused&&(l.timeout=setInterval(l.callback,l.time),l.paused=!1);for(var[,u]of this.unpauseCallbacks)u();this.unpauseCallbacks.clear()}for(var[c,h]of this.viewLists)h.pause(!!e);for(var d in this.tags)if(Array.isArray(this.tags[d]))for(var v in this.tags[d])this.tags[d][v].pause(!!e);else this.tags[d].pause(!!e)}render(e=null,t=null,r=null){var{document:i}=globalThis.window;if(e instanceof m&&(e=e.firstNode.parentNode),t instanceof m&&(t=t.firstNode),this.firstNode)return this.reRender(e,t,r);this.dispatchEvent(new CustomEvent("render"));var s,n="object"==typeof this.template&&"function"==typeof this.template.cloneNode,a=n||m.templates.has(this.template);if(s=a?n?this.template.cloneNode(!0):m.templates.get(this.template).cloneNode(!0):i.createRange().createContextualFragment(this.template),a||n||m.templates.set(this.template,s.cloneNode(!0)),this.mainView||this.preRuleSet.apply(s,this),this.mapTags(s),this.mainView||this.ruleSet.apply(s,this),!0===globalThis.devMode?(this.firstNode=i.createComment(`Template ${this._id} Start`),this.lastNode=i.createComment(`Template ${this._id} End`)):(this.firstNode=i.createTextNode(""),this.lastNode=i.createTextNode("")),this.nodes.push(this.firstNode,...Array.from(s.childNodes),this.lastNode),this.postRender(e),this.dispatchEvent(new CustomEvent("rendered")),this.dispatchAttach()){if(e){t?(e.insertBefore(this.firstNode,t),e.insertBefore(this.lastNode,t)):(e.insertBefore(this.firstNode,null),e.insertBefore(this.lastNode,null)),e.insertBefore(s,this.lastNode);var o=e.getRootNode();if(o.isConnected)this.attached(o,e),this.dispatchAttached(o,e,r);else if(r){var l=t=>{var i=e.getRootNode();this.attached(i,e),this.dispatchAttached(i,e,r),r.removeEventListener("attached",l)};r.addEventListener("attached",l)}}return this.renderComplete(this.nodes),this.nodes}}dispatchAttach(){var{CustomEvent:e}=globalThis.window;return this.dispatchEvent(new e("attach",{cancelable:!0,target:this}))}dispatchAttached(e,t,r){var{CustomEvent:i}=globalThis.window;for(var s of(this.dispatchEvent(new i("attached",{detail:{view:r||this,node:t,root:e,mainView:this}})),this.dispatchDomAttached(r),this.nodesAttached.items()))s(e,t)}dispatchDomAttached(e){var{Node:t,CustomEvent:r}=globalThis.window;this.nodes.filter(e=>e.nodeType!==t.COMMENT_NODE).forEach(t=>{t.matches&&(t.dispatchEvent(new r("cvDomAttached",{target:t,detail:{view:e||this,mainView:this}})),o.Dom.mapTags(t,!1,(t,i)=>{t.matches&&t.dispatchEvent(new r("cvDomAttached",{target:t,detail:{view:e||this,mainView:this}}))}))})}reRender(e,t,r){var{CustomEvent:i}=globalThis.window;if(this.dispatchEvent(new i("reRender"),{cancelable:!0,target:this,view:r})){var s=new DocumentFragment;if(this.firstNode.isConnected){var n=this.nodesDetached.items();for(var a in n)n[a]()}if(s.append(...this.nodes),e){t?(e.insertBefore(this.firstNode,t),e.insertBefore(this.lastNode,t)):(e.insertBefore(this.firstNode,null),e.insertBefore(this.lastNode,null)),e.insertBefore(s,this.lastNode),this.dispatchEvent(new i("reRendered"),{cancelable:!0,target:this,view:r});var o=e.getRootNode();o.isConnected&&(this.attached(o,e),this.dispatchAttached(o,e))}return this.nodes}}mapTags(e){o.Dom.mapTags(e,!1,(e,t)=>{e[v]||(e=e.matches?(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=this.mapInterpolatableTag(e)).matches("[cv-template]")&&this.mapTemplateTag(e)||e).matches("[cv-slot]")&&this.mapSlotTag(e)||e).matches("[cv-prerender]")&&this.mapPrendererTag(e)||e).matches("[cv-link]")&&this.mapLinkTag(e)||e).matches("[cv-attr]")&&this.mapAttrTag(e)||e).matches("[cv-expand]")&&this.mapExpandableTag(e)||e).matches("[cv-ref]")&&this.mapRefTag(e)||e).matches("[cv-on]")&&this.mapOnTag(e)||e).matches("[cv-each]")&&this.mapEachTag(e)||e).matches("[cv-bind]")&&this.mapBindTag(e)||e).matches("[cv-with]")&&this.mapWithTag(e)||e).matches("[cv-if]")&&this.mapIfTag(e)||e).matches("[cv-view]")&&this.mapViewTag(e)||e:this.mapInterpolatableTag(e))!==t.currentNode&&(t.currentNode=e)}),this.postMapping.forEach(e=>e())}mapExpandableTag(e){var t=e[p];t&&(t(),e[p]=!1);var[r,s]=i.Bindable.resolve(this.args,e.getAttribute("cv-expand"),!0);return e.removeAttribute("cv-expand"),r[s]||(r[s]={}),r[s]=i.Bindable.make(r[s]),this.onRemove(e[p]=r[s].bindTo((t,r,i,s,n)=>{s||void 0===t?e.removeAttribute(r,t):null!==t?e.setAttribute(r,t):e.setAttribute(r,"")})),e}mapAttrTag(e){var t=this.compileAttrTag(e)(this);return e.replaceWith(t),t}compileAttrTag(e){var t=e.getAttribute("cv-attr").split(/[,;]/).map(e=>e.split(":"));return e.removeAttribute("cv-attr"),r=>{var s=e.cloneNode(!0),n=function(){var e=t[a][1]||t[a][0],[n,o]=i.Bindable.resolve(r.args,e,!0),l=t[a][0];r.onRemove(n.bindTo(o,(e,t,r,i)=>{i||void 0===e?s.removeAttribute(l,e):null!==e?s.setAttribute(l,e):s.setAttribute(l,"")}))};for(var a in t)n();return s}}mapInterpolatableTag(e){var t=this,r=this.interpolateRegex,{Node:s,document:n}=globalThis.window;if(e.nodeType===s.TEXT_NODE){var a=e.nodeValue;if(!this.interpolatable(a))return e;for(var o,u,c=0,h=function(){var r=o[2],u=!1,h=!1,p=r.split("|"),f=!1;if(p.length>1&&(f=t.stringTransformer(p.slice(1)),r=p[0]),"$$"===r.substr(0,2)&&(u=!0,h=!0,r=r.substr(2)),"$"===r.substr(0,1)&&(u=!0,r=r.substr(1)),"000"===r.substr(0,3))return expand=!0,r=r.substr(3),0;var g=a.substring(c,o.index);c=o.index+o[1].length;var b,y=n.createTextNode(g);y[v]=!0,e.parentNode.insertBefore(y,e),(b=u?n.createElement("div"):n.createTextNode(""))[v]=!0;var w=t.args,j=r;if(r.match(/\./)&&([w,j]=i.Bindable.resolve(t.args,r,!0)),e.parentNode.insertBefore(b,e),"object"!=typeof w)return 1;var E=(w=i.Bindable.make(w)).bindTo(j,(r,i,n)=>{if(n[i]!==r&&(n[i]instanceof m||n[i]instanceof s||n[i]instanceof l.Tag)&&(n[i].preserve||n[i].remove()),h&&!(r instanceof m)){var a=null!==r&&void 0!==r?r:"";(r=new m(t.args,t)).template=a}if(f&&(r=f(r)),r instanceof m){b.nodeValue="",r[d.EventTargetMixin.Parent]=t,r.render(e.parentNode,b,t);var o=()=>{r.preserve||r.remove()};t.onRemove(o),r.onRemove(()=>t._onRemove.remove(o))}else r instanceof s?(b.nodeValue="",e.parentNode.insertBefore(r,b),t.onRemove(()=>r.remove())):r instanceof l.Tag?(b.nodeValue="",r.node?(e.parentNode.insertBefore(r.node,b),t.onRemove(()=>r.remove())):r.remove()):(r instanceof Object&&r.__toString instanceof Function&&(r=r.__toString()),u?b.innerHTML=r:b.nodeValue=r);b[v]=!0});t.onRemove(E)};(o=r.exec(a))&&(0===(u=h())||1!==u););var p=a.substring(c),f=n.createTextNode(p);f[v]=!0,e.parentNode.insertBefore(f,e),e.nodeValue=""}else if(e.nodeType===s.ELEMENT_NODE)for(var g=function(){if(!t.interpolatable(e.attributes[b].value))return 1;for(var s,n=0,a=e.attributes[b].value,o=e.attributes[b],l={},u=[];s=r.exec(a);)u.push(a.substring(n,s.index)),l[s[2]]||(l[s[2]]=[]),l[s[2]].push(u.length),u.push(s[1]),n=s.index+s[1].length;u.push(a.substring(n));var c=function(){var r=t.args,s=h,n=h.split("|"),a=!1,c=h;n.length>1&&(a=t.stringTransformer(n.slice(1)),s=n[0]),s.match(/\./)&&([r,s]=i.Bindable.resolve(t.args,s,!0));l[c];t.onRemove(r.bindTo(s,(r,i,n,h)=>{for(var d in a&&(r=a(r)),l)for(var v in l[c])u[l[c][v]]=n[d],i===s&&(u[l[c][v]]=r);t.paused?t.unpauseCallbacks.set(o,()=>e.setAttribute(o.name,u.join(""))):e.setAttribute(o.name,u.join(""))}))};for(var h in l)c()},b=0;b<e.attributes.length;b++)g();return e}mapRefTag(e){var t=e.getAttribute("cv-ref"),[r,i=null,s=null]=t.split(":"),n=l.Tag;i&&(n=this.stringToClass(i)),e.removeAttribute("cv-ref"),Object.defineProperty(e,"___tag___",{enumerable:!1,writable:!0}),this.onRemove(()=>{e.___tag___=null,e.remove()});var a=this;this.viewList&&(a=this.viewList.parent);var o=new n(e,this,r,void 0,this);for(e.___tag___=o,this.tags[r]=o;a;){var u=this.args[s];if(void 0!==u?(a.tags[r]||(a.tags[r]=[]),a.tags[r][u]=o):a.tags[r]=o,!a.parent)break;a=a.parent}return e}mapBindTag(e){var t=e.getAttribute("cv-bind"),r=this.args,s=t,n=null;t.match(/\./)&&([r,s,n]=i.Bindable.resolve(this.args,t,!0)),r!==this.args&&(this.subBindings[t]=this.subBindings[t]||[],this.onRemove(this.args.bindTo(n,()=>{for(;this.subBindings.length;)this.subBindings.shift()()})));var a=!1;"$"===s.substr(0,1)&&(s=s.substr(1),a=!0);var u=!1,c=r.bindTo(s,(t,r,i,s,n)=>{if((n instanceof m||n instanceof Node||n instanceof l.Tag)&&n!==t&&n.remove(),["INPUT","SELECT","TEXTAREA"].includes(e.tagName)){var c=e.getAttribute("type");if(c&&"checkbox"===c.toLowerCase())e.checked=!!t;else if(c&&"radio"===c.toLowerCase())e.checked=t==e.value;else if("file"!==c)if("SELECT"===e.tagName){var h=()=>{for(var r=0;r<e.options.length;r++){e.options[r].value==t&&(e.selectedIndex=r)}};h(),this.nodesAttached.add(h)}else e.value=null==t?"":t;u&&e.dispatchEvent(new CustomEvent("cvAutoChanged",{bubbles:!0})),u=!0}else if(t instanceof m){for(var p of e.childNodes)p.remove();t[d.EventTargetMixin.Parent]=this,t.render(e,null,this)}else if(t instanceof Node)e.insert(t);else if(t instanceof l.Tag)e.append(t.node);else if(a){if(e.innerHTML!==t){if(t=String(t),e.innerHTML===t.substring(0,e.innerHTML.length))e.innerHTML+=t.substring(e.innerHTML.length);else{for(var f of e.childNodes)f.remove();e.innerHTML=t}o.Dom.mapTags(e,!1,e=>e[v]=!0)}}else if(e.textContent!==t){for(var g of e.childNodes)g.remove();e.textContent=t}});r!==this.args&&this.subBindings[t].push(c),this.onRemove(c);var h=e.getAttribute("type"),p=e.getAttribute("multiple"),f=t=>{if(t.target===e)if(h&&"checkbox"===h.toLowerCase())e.checked?r[s]=t.target.getAttribute("value"):r[s]=!1;else if(t.target.matches("[contenteditable=true]"))r[s]=t.target.innerHTML;else if("file"===h&&p){var n=Array.from(t.target.files),a=r[s]||i.Bindable.onDeck(r,s);if(a&&n.length){var o=function(e){if(n[e]!==a[e])return n[e].toJSON=(()=>({name:file[e].name,size:file[e].size,type:file[e].type,date:file[e].lastModified})),a[e]=n[e],1};for(var l in n)if(o(l))break}else r[s]=n}else if("file"===h&&!p&&t.target.files.length){var u=t.target.files.item(0);u.toJSON=(()=>({name:u.name,size:u.size,type:u.type,date:u.lastModified})),r[s]=u}else r[s]=t.target.value};return"file"===h||"radio"===h?e.addEventListener("change",f):(e.addEventListener("input",f),e.addEventListener("change",f),e.addEventListener("value-changed",f)),this.onRemove(()=>{"file"===h||"radio"===h?e.removeEventListener("change",f):(e.removeEventListener("input",f),e.removeEventListener("change",f),e.removeEventListener("value-changed",f))}),e.removeAttribute("cv-bind"),e}mapOnTag(e){return String(e.getAttribute("cv-on")).split(";").map(e=>e.split(":")).forEach(t=>{var r=(t=t.map(e=>e.trim())).length,i=String(t.shift()).trim(),s=String(t.shift()||i).trim(),n=String(t.shift()||"").trim(),a=[],o=/(\w+)(?:\(([$\w\s-'",]+)\))?/.exec(s);o&&(s=o[1].replace(/(^[\s\n]+|[\s\n]+$)/,""),o[2]&&(a=o[2].split(",").map(e=>e.trim()))),a.length||a.push("$event"),i&&1!==r||(i=s);var l=t=>{for(var r,i=this,n=function(){var e=i.controller;return"function"==typeof e[s]?(r=((...t)=>{e[s](...t)}),0):"function"==typeof i[s]?(r=((...e)=>{i[s](...e)}),0):i.parent?void(i=i.parent):0};i&&0!==n(););var o=a.map(r=>{var s;return Number(r)==r?r:"event"===r||"$event"===r?t:"$view"===r?i:"$controller"===r?controller:"$tag"===r?e:"$parent"===r?this.parent:"$subview"===r?this:r in this.args?this.args[r]:(s=/^['"]([\w-]+?)["']$/.exec(r))?s[1]:void 0});if("function"!=typeof r)throw new Error(`${s} is not defined on View object.`+"\nTag:\n"+`${e.outerHTML}`);r(...o)},u={};switch(n.includes("p")?u.passive=!0:n.includes("P")&&(u.passive=!1),n.includes("c")?u.capture=!0:n.includes("C")&&(u.capture=!1),n.includes("o")?u.once=!0:n.includes("O")&&(u.once=!1),i){case"_init":l();break;case"_attach":this.nodesAttached.add(l);break;case"_detach":this.nodesDetached.add(l);break;default:e.addEventListener(i,l,u),this.onRemove(()=>{e.removeEventListener(i,l,u)})}return[i,s,a]}),e.removeAttribute("cv-on"),e}mapLinkTag(e){var t=e.getAttribute("cv-link");e.setAttribute("href",t);var r=r=>{r.preventDefault(),"http"!==t.substring(0,4)&&"//"!==t.substring(0,2)?n.Router.go(e.getAttribute("href")):globalThis.open(e.getAttribute("href",t))};return e.addEventListener("click",r),this.onRemove(((e,t)=>()=>{e.removeEventListener("click",t),e=void 0,t=void 0})(e,r)),e.removeAttribute("cv-link"),e}mapPrendererTag(e){var t=e.getAttribute("cv-prerender"),r=globalThis.prerenderer||navigator.userAgent.match(/prerender/i);return e.removeAttribute("cv-prerender"),r&&(globalThis.prerenderer=globalThis.prerenderer||!0),("never"===t&&r||"only"===t&&!r)&&this.postMapping.add(()=>e.parentNode.removeChild(e)),e}mapWithTag(e){var t=this,r=e.getAttribute("cv-with"),s=e.getAttribute("cv-carry"),n=e.getAttribute("cv-view");e.removeAttribute("cv-with"),e.removeAttribute("cv-carry"),e.removeAttribute("cv-view");var a=n?this.stringToClass(n):m,o=new DocumentFragment;[...e.childNodes].forEach(e=>o.appendChild(e));var l=[];s&&(l=s.split(",").map(e=>e.trim()));var u=this.args.bindTo(r,(r,s,n,u)=>{for(this.withViews.has(e)&&this.withViews.delete(e);e.firstChild;)e.removeChild(e.firstChild);var c=new a({},this);this.onRemove((e=>()=>{e.remove()})(c)),c.template=o;var h=function(){var e=t.args.bindTo(l[d],(e,t)=>{c.args[t]=e});c.onRemove(e),t.onRemove(()=>{e(),c.remove()})};for(var d in l)h();var v=function(){if("object"!=typeof r)return 1;var e=(r=i.Bindable.make(r)).bindTo(p,(e,t,r,i)=>{i?t in c.args&&delete c.args[t]:c.args[t]=e});c.args.bindTo(p,(e,t,i,s)=>{s?t in r&&delete r[t]:r[t]=e});t.onRemove(()=>{e(),r.isBound()||i.Bindable.clearBindings(r),c.remove()}),c.onRemove(()=>{e(),r.isBound()||i.Bindable.clearBindings(r)})};for(var p in r)v();c.render(e,null,this),this.withViews.set(e,c)});return this.onRemove(()=>{this.withViews.delete(e),u()}),e}mapViewTag(e){var t=e.getAttribute("cv-view");e.removeAttribute("cv-view");var r=new DocumentFragment;[...e.childNodes].forEach(e=>r.appendChild(e));var i=t.split(":"),s=i.shift(),n=new(i.length?this.stringToClass(i[0]):m)(this.args,this);return this.views.set(e,n),this.views.set(s,n),this.onRemove(()=>{n.remove(),this.views.delete(e),this.views.delete(s)}),n.template=r,n.render(e,null,this),e}mapEachTag(e){var t=e.getAttribute("cv-each"),r=e.getAttribute("cv-view");e.removeAttribute("cv-each"),e.removeAttribute("cv-view");var n=r?this.stringToClass(r):m,a=new DocumentFragment;[...e.childNodes].forEach(e=>a.appendChild(e));var[o,l,c]=t.split(":"),h=this.args,d=o;o.match(/\./)&&([h,d]=i.Bindable.resolve(this.args,o,!0));var v=h.bindTo(d,(t,r,i,o,h)=>{t instanceof u.Bag&&(t=t.list),this.viewLists.has(e)&&this.viewLists.get(e).remove();var d=new s.ViewList(a,l,t,this,c,n),v=()=>d.remove();this.onRemove(v),d.onRemove(()=>this._onRemove.remove(v));var p=this.args.bindTo((e,t,r,i)=>{"_id"!==t&&(i?t in d.subArgs&&delete d.subArgs[t]:d.subArgs[t]=e)}),f=d.args.bindTo((e,t,r,i,s)=>{"_id"!==t&&"value"!==t&&"___"!==String(t).substring(0,3)&&(i?delete this.args[t]:t in this.args&&(this.args[t]=e))});for(d.onRemove(p),d.onRemove(f),this.onRemove(p),this.onRemove(f);e.firstChild;)e.removeChild(e.firstChild);this.viewLists.set(e,d),d.render(e,null,this),"SELECT"===e.tagName&&d.reRender()});return this.onRemove(v),e}mapIfTag(e){var t=e,r=t.getAttribute("cv-view"),s=t.getAttribute("cv-if"),n=t.getAttribute("cv-is"),a=!1,l=!1;t.removeAttribute("cv-view"),t.removeAttribute("cv-if"),t.removeAttribute("cv-is");var c=r?this.stringToClass(r):m;"!"===s.substr(0,1)&&(s=s.substr(1),a=!0),"?"===s.substr(0,1)&&(s=s.substr(1),l=!0);var h=new DocumentFragment;[...t.childNodes].forEach(e=>h.appendChild(e));var d=this,v=new DocumentFragment,p=new c(this.args,d);p.tags.bindTo((e,t)=>this.tags[t]=e,{removeWith:this}),p.template=h;var f=d.args,g=s;s.match(/\./)&&([f,g]=i.Bindable.resolve(d.args,s,!0)),p.render(v,null,this);var b=f.bindTo(g,(t,r)=>{var i=t;l&&(t=null!==t&&void 0!==t),t instanceof u.Bag&&(t=t.list),Array.isArray(t)&&(t=!!t.length),null!==n&&(t=i==n),a&&(t=!t),t?(e.appendChild(v),[...v.childNodes].forEach(e=>o.Dom.mapTags(e,!1,(e,t)=>{e.matches&&e.dispatchEvent(new CustomEvent("cvDomAttached",{target:e,detail:{view:p||this,mainView:this}}))}))):(p.nodes.forEach(e=>v.appendChild(e)),o.Dom.mapTags(v,!1,(e,t)=>{e.matches&&new CustomEvent("cvDomDetached",{target:e,detail:{view:p||this,mainView:this}})}))},{children:Array.isArray(f[g])});d.onRemove(b);return d.onRemove(()=>{b(),d._onRemove.remove(b)}),this.onRemove(()=>{p.remove(),d!==this&&d.remove()}),e}mapTemplateTag(e){var t=e.getAttribute("cv-template");e.removeAttribute("cv-template");var r=e.innerHTML;return m.templates.has(r)||m.templates.set(r,document.createRange().createContextualFragment(e.innerHTML)),this.templates[t]=m.templates.get(r),this.postMapping.add(()=>e.remove()),e}mapSlotTag(e){var t=e.getAttribute("cv-slot"),r=this.templates[t];if(!r){for(var i=this;i&&!(r=i.templates[t]);)i=i.parent;if(!r)return void console.error(`Template ${t} not found.`)}for(e.removeAttribute("cv-slot");e.firstChild;)e.firstChild.remove();return"string"==typeof r&&(m.templates.has(r)||m.templates.set(r,document.createRange().createContextualFragment(r)),r=m.templates.get(r)),e.appendChild(r.cloneNode(!0)),e}postRender(e){}attached(e){}interpolatable(e){return!!String(e).match(this.interpolateRegex)}static uuid(){return new a.Uuid}remove(e=!1){if(this.dispatchEvent(new CustomEvent("remove",{detail:{view:this},cancelable:!0}))){var t=()=>{for(var e in this.tags)Array.isArray(this.tags[e])?(this.tags[e]&&this.tags[e].forEach(e=>e.remove()),this.tags[e].splice(0)):(this.tags[e]&&this.tags[e].remove(),this.tags[e]=void 0);for(var t in this.nodes)this.nodes[t]&&this.nodes[t].dispatchEvent(new Event("cvDomDetached")),this.nodes[t]&&this.nodes[t].remove(),this.nodes[t]=void 0;this.nodes.splice(0),this.firstNode=this.lastNode=void 0};e?t():requestAnimationFrame(t);var r=this._onRemove.items();for(var i of r)i(),this._onRemove.remove(i);for(var s of this.cleanup)s&&s();for(var[n,a]of(this.cleanup.length=0,this.viewLists))a.remove();for(var[o,l]of(this.viewLists.clear(),this.timeouts))clearTimeout(l.timeout),this.timeouts.delete(l.timeout);for(var u of this.intervals)clearInterval(u);for(var c of(this.intervals.length=0,this.frames))c();this.frames.length=0,this.preRuleSet.purge(),this.ruleSet.purge(),this.removed=!0,this.dispatchEvent(new CustomEvent("removed",{detail:{view:this},cancelable:!0}))}}findTag(e){for(var t in this.nodes){var r;if(this.nodes[t].querySelector){if(this.nodes[t].matches(e))return new l.Tag(this.nodes[t],this,void 0,void 0,this);if(r=this.nodes[t].querySelector(e))return new l.Tag(r,this,void 0,void 0,this)}}}findTags(e){var t=this.nodes.filter(t=>t.matches&&t.matches(e)),r=this.nodes.filter(e=>e.querySelectorAll).map(t=>[...t.querySelectorAll(e)]).flat().map(e=>new l.Tag(e,this,void 0,void 0,this))||[];return t.concat(r)}onRemove(e){e instanceof Event||this._onRemove.add(e)}update(){}beforeUpdate(e){}afterUpdate(e){}stringTransformer(e){return t=>{for(var r in e){for(var i=this,s=e[r];i&&!i[s];)i=i.parent;if(!i)return;t=i[e[r]](t)}return t}}stringToClass(e){if(m.refClasses.has(e))return m.refClasses.get(e);var r=e.split("/"),i=r[r.length-1],s=t(e);return m.refClasses.set(e,s[i]),s[i]}preventParsing(e){e[v]=!0}toString(){return this.nodes.map(e=>e.outerHTML).join(" ")}listen(e,t,r,i){if("string"==typeof e&&(i=r,r=t,t=e,e=this),e instanceof m)return this.listen(e.nodes,t,r,i);if(Array.isArray(e))return e.map(e=>this.listen(e,t,r,i));if(e instanceof l.Tag)return this.listen(e.element,t,r,i);e.addEventListener(t,r,i);var s=()=>e.removeEventListener(t,r,i),n=()=>{s(),s=(()=>{})};return this.onRemove(()=>n()),n}detach(){for(var e in this.nodes)this.nodes[e].remove();return this.nodes}}e.View=m,Object.defineProperty(m,"templates",{value:new Map}),Object.defineProperty(m,"refClasses",{value:new Map})}),require.register("curvature/base/ViewList.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ViewList=void 0;var i=t("./Bindable"),s=t("./SetMap"),n=t("./Bag");e.ViewList=class{constructor(e,t,r,s,a=null,o=null){this.removed=!1,this.args=i.Bindable.makeBindable(Object.create(null)),this.args.value=i.Bindable.makeBindable(r||Object.create(null)),this.subArgs=i.Bindable.makeBindable(Object.create(null)),this.views=[],this.cleanup=[],this.viewClass=o,this._onRemove=new n.Bag,this.template=e,this.subProperty=t,this.keyProperty=a,this.tag=null,this.downDebind=[],this.upDebind=[],this.paused=!1,this.parent=s,this.viewCount=0,this.rendered=new Promise((e,t)=>{Object.defineProperty(this,"renderComplete",{configurable:!1,writable:!0,value:e})}),this.willReRender=!1,this.args.___before((e,t,r,i,s)=>{"bindTo"!=t&&(this.paused=!0)}),this.args.___after((e,t,r,i,s)=>{"bindTo"!=t&&(this.paused=r.length>1,this.reRender())});var l=this.args.value.bindTo((e,t,r,i)=>{if(!this.paused){var s=t;if("symbol"!=typeof t)if(isNaN(t)&&(s="_"+t),i)for(var n in this.views[s]&&this.views[s].remove(!0),delete this.views[s],this.views)this.views[n]&&(isNaN(n)?this.views[n].args[this.keyProperty]=n.substr(1):this.views[n].args[this.keyProperty]=n);else this.views[s]?this.views[s]&&this.views[s].args&&(this.views[s].args[this.keyProperty]=t,this.views[s].args[this.subProperty]=e):this.viewCount?!1===this.willReRender&&(this.willReRender=requestAnimationFrame(()=>{this.willReRender=!1,this.reRender()})):this.reRender()}},{wait:0});this._onRemove.add(l),Object.preventExtensions(this)}render(e){var t=this,r=[],i=function(i){i.viewList=t,i.render(e,null,t.parent),r.push(i.rendered.then(()=>i))};for(var s of this.views)i(s);this.tag=e,Promise.all(r).then(e=>this.renderComplete(e)),this.parent.dispatchEvent(new CustomEvent("listRendered",{detail:{detail:{key:this.subProperty,value:this.args.value}}}))}reRender(){var e=this;if(!this.paused&&this.tag){var t=[],r=new s.SetMap;for(var i in this.views){var n=this.views[i];if(void 0!==n){var a=n.args[this.subProperty];r.add(a,n),t[i]=n}else t[i]=n}var o=[],l=new Set;this.downDebind.length&&this.downDebind.forEach(e=>e&&e()),this.upDebind.length&&this.upDebind.forEach(e=>e&&e()),this.upDebind.length=0,this.downDebind.length=0;var u=1/0,c=1/0,h=function(){var t=!1,i=d;if(isNaN(i)?i="_"+d:String(i).length&&(i=Number(i)),void 0!==e.args.value[d]&&r.has(e.args.value[d])){var s=r.getOne(e.args.value[d]);s&&(s.args[e.keyProperty]=d,o[i]=s,l.add(s),t=!0,isNaN(i)||(u=Math.min(u,i),i>0&&(c=Math.min(c,i))),r.remove(e.args.value[d],s))}if(!t){var n=Object.create(null),a=o[i]=new e.viewClass(n,e.parent);isNaN(i)||(u=Math.min(u,i),i>0&&(c=Math.min(c,i))),o[i].template=e.template,o[i].viewList=e,o[i].args[e.keyProperty]=d,o[i].args[e.subProperty]=e.args.value[d],e.upDebind[i]=n.bindTo(e.subProperty,(t,r,i,s)=>{var a=n[e.keyProperty];s?delete e.args.value[a]:e.args.value[a]=t}),e.downDebind[i]=e.subArgs.bindTo((e,t,r,i)=>{i?delete n[t]:n[t]=e});var h=()=>{e.upDebind.filter(e=>e).forEach(e=>e()),e.upDebind.length=0},v=()=>{e.downDebind.filter(e=>e).forEach(e=>e()),e.downDebind.length=0};a.onRemove(()=>{e._onRemove.remove(h),e._onRemove.remove(v),e.upDebind[i]&&e.upDebind[i](),e.downDebind[i]&&e.downDebind[i](),delete e.upDebind[i],delete e.downDebind[i]}),e._onRemove.add(h),e._onRemove.add(v),n[e.subProperty]=e.args.value[d]}};for(var d in this.args.value)h();for(var v in t)t[v]&&!l.has(t[v])&&t[v].remove(!0);if(Array.isArray(this.args.value)){var p=0===u&&void 0!==o[1]&&o.length>1||c===1/0?u:c,f=(e=0)=>{for(var t=o.length-e-1;t>p&&void 0===o[t];)t--;return t<p?Promise.resolve():o[t]===this.views[t]?o[t]&&!o[t].firstNode?(o[t].render(this.tag,o[t+1],this.parent),o[t].rendered.then(()=>f(Number(e)+1))):0===e||e%500?f(Number(e)+1):new Promise(t=>requestAnimationFrame(()=>t(f(Number(e)+1)))):(o[t].render(this.tag,o[t+1],this.parent),this.views.splice(t,0,o[t]),o[t].rendered.then(()=>f(e+1)))};this.rendered=f()}else{var m=[],g=Object.assign(Object.create(null),o),b=e=>parseInt(e)===e-0,y=Object.keys(o).sort((e,t)=>b(e)&&b(t)?Math.sign(e-t):b(e)||b(t)?!b(e)&&b(t)?-1:b(e)&&!b(t)?1:void 0:0),w=function(t){if(delete g[t],o[t].firstNode&&o[t]===e.views[t])return 1;o[t].render(e.tag,null,e.parent),m.push(o[t].rendered.then(()=>o[t]))};for(var j of y)w(j);for(var E in g)delete this.args.views[E],g.remove(!0);this.rendered=Promise.all(m)}for(var P in o)isNaN(P)?o[P].args[this.keyProperty]=P.substr(1):o[P].args[this.keyProperty]=P;return this.views=Array.isArray(this.args.value)?[...o]:o,this.viewCount=o.length,l.clear(),this.willReRender=!1,this.rendered.then(()=>{this.parent.dispatchEvent(new CustomEvent("listRendered",{detail:{detail:{key:this.subProperty,value:this.args.value,tag:this.tag}}})),this.tag.dispatchEvent(new CustomEvent("listRendered",{detail:{detail:{key:this.subProperty,value:this.args.value,tag:this.tag}}}))}),this.rendered}}pause(e=!0){for(var t in this.views)this.views[t].pause(e)}onRemove(e){this._onRemove.add(e)}remove(){for(var e in this.views)this.views[e]&&this.views[e].remove(!0);var t=this._onRemove.items();for(var r in t)this._onRemove.remove(t[r]),t[r]();for(;this.cleanup.length;)this.cleanup.pop()();for(this.views=[];this.tag&&this.tag.firstChild;)this.tag.removeChild(this.tag.firstChild);this.subArgs&&i.Bindable.clearBindings(this.subArgs),i.Bindable.clearBindings(this.args),this.removed=!0}}}),require.register("curvature/form/ButtonField.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ButtonField=void 0;var i=t("./Field");e.ButtonField=class extends i.Field{constructor(e,t,r,i){super(e,t,r,i),this.args.title=this.args.title||this.args.value,this._onClick=[];var s=this.args.attrs||{};s.type=s.type||this.args.type,this.args.name=s.name=this.args.name||i,this.template=`\n\t\t\t<label\n\t\t\t\tfor       = "${this.getName()}"\n\t\t\t\tdata-type = "${s.type}"\n\t\t\t\tcv-ref    = "label:curvature/base/Tag">\n\t\t\t\t<input\n\t\t\t\t\tname      = "${this.getName()}"\n\t\t\t\t\ttype      = "${s.type}"\n\t\t\t\t\tvalue     = "[[value]]"\n\t\t\t\t\tcv-on     = "click:clicked(event)"\n\t\t\t\t\tcv-ref    = "input:curvature/base/Tag"\n\t\t\t\t\tcv-expand = "attrs"\n\t\t\t\t/>\n\t\t\t</label>\n\t\t`}clicked(e){this._onClick.map(t=>!1===t(e)).filter(e=>e).length?"submit"==this.args.attrs.type&&(e.preventDefault(),e.stopPropagation()):"submit"==this.args.attrs.type&&(e.preventDefault(),e.stopPropagation(),this.form.tags.formTag.element.dispatchEvent(new Event("submit",{cancelable:!0,bubbles:!0})))}onClick(e){this._onClick.push(e)}}}),require.register("curvature/form/Field.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Field=void 0;var i=t("../base/View");t("../base/Bindable");e.Field=class extends i.View{constructor(e,t,r,i){var s,n,a,o=Object.assign({},e);super(o,r),this.args.title=null!==(s=this.args.title)&&void 0!==s?s:i,this.args.value=null!==(n=this.args.value)&&void 0!==n?n:"",this.value=null!==(a=this.args.value)&&void 0!==a?a:"",this.skeleton=o,this.disabled=null,this.args.valueString="",this.form=t,this.key=i,this.ignore=this.args.attrs&&this.args.attrs["data-cv-ignore"]||!1;var l="",u=this.args.attrs||{};u.type=u.type||o.type||null,this.args.name=u.name=u.name||this.args.name||i,"checkbox"==u.type&&(l='value = "1"'),this.template=`\n\t\t\t<label\n\t\t\t\tfor           = "${this.getName()}"\n\t\t\t\tdata-type     = "${u.type||"text"}"\n\t\t\t\tcv-ref        = "label:curvature/base/Tag"\n\t\t\t>\n\t\t\t\t<span cv-if = "title">\n\t\t\t\t\t<span cv-ref = "title:curvature/base/Tag">[[title]]</span>\n\t\t\t\t</span>\n\t\t\t\t<input\n\t\t\t\t\tname      = "${this.getName()}"\n\t\t\t\t\ttype      = "${u.type||"text"}"\n\t\t\t\t\tcv-bind   = "value"\n\t\t\t\t\tcv-ref    = "input:curvature/base/Tag"\n\t\t\t\t\tcv-expand = "attrs"\n\t\t\t\t\t${l}\n\t\t\t\t/>\n\t\t\t\t<span cv-each = "errors:error:e">\n\t\t\t\t\t<p class = "cv-error">[[error]]</p>\n\t\t\t\t</span>\n\t\t\t</label>\n\t\t`;var c=null;this.args.bindTo("value",(e,t)=>{if(!isNaN(e)&&null!==e&&e.length&&e==Number(e)&&e.length===String(Number(e)).length&&(e=Number(e)),this.value=e,c!=t){if(c=i,this.args.valueString=JSON.stringify(e||"",null,4),this.valueString=this.args.valueString,"file"==u.type&&this.tags.input&&this.tags.input.element.files&&this.tags.input.element.length)if(this.tags.input.node.removeAttribute("title"),u.multiple){var r=Array.from(this.tags.input.element.files);if(this.parent.args.value[t]&&r.length){for(var s in r)r[s]!==this.parent.args.value[i][s]&&(this.parent.args.value[i]=r);this.parent.args.value.splice(r.length)}else this.parent.args.value[i]=r}else this.parent.args.value[i]=this.tags.input.element.files[0];else"file"==u.type&&this.tags.input?!e&&this.tags.input?(this.tags.input.node.value=null,u.placeholder?this.tags.input.node.setAttribute("title",u.placeholder):this.tags.input.node.removeAttribute("title")):e instanceof File&&this.tags.input.node.setAttribute("title",e.name):(this.parent.args.value||(this.parent.args.value={}),this.parent.args.value[i]=e);this.args.errors=[],c=null}}),this.parent.args.value[this.key]=this.args.value,this.parent.args.value.bindTo(i,(e,t)=>{if(c!=t){if(c=t,"file"==u.type)if(this.tags.input&&this.tags.input.element.files&&this.tags.input.element.files.length)if(u.multiple){var r=Array.from(this.tags.input.element.files);if(this.parent.args.value[i]&&r.length){for(var s in r)r[s]!==this.parent.args.value[i][s]&&(this.parent.args.value[i]=r);this.parent.args.value[i].splice(r.length)}else this.parent.args.value[i]=r}else this.parent.args.value[i]=this.tags.input.element.files[0];else this.args.value=e;else this.args.value=e;c=null}})}disable(){this.hasChildren(),this.disabled="disabled"}enable(){this.hasChildren(),this.disabled=!1}hasChildren(){return!1}getName(e=!0){if(this.tags.input)return this.tags.input.element.getAttribute("name");var t=this.key;if(e){for(var r=this.parent,i=[t];r&&r.array&&void 0!==r.key;)i.unshift(r.key),r=r.parent;t=i.shift(),i.length&&(t+=`[${i.join("][")}]`)}return t}}}),require.register("curvature/form/FieldSet.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FieldSet=void 0;var i=t("./Field"),s=t("./Form");e.FieldSet=class extends i.Field{constructor(e,t,r,i){super(e,t,r,i);var n=this.args.attrs||{};n.type=n.type||"fieldset",this.array=!1,(e.array||n["data-array"]||n["data-multi"])&&(this.array=n["data-array"]=!0),this.args.value={},this.args.fields=s.Form.renderFields(e.children,this),this.fields=this.args.fields,this.template=`\n\t\t\t<label\n\t\t\t\tfor        = "${this.getName()}"\n\t\t\t\tdata-type  = "${n.type}"\n\t\t\t\tdata-multi = "${n["data-multi"]?"true":"false"}"\n\t\t\t\tcv-ref     = "label:curvature/base/Tag"\n\t\t\t>\n\t\t\t\t<span cv-if = "title">\n\t\t\t\t\t<span cv-ref = "title:curvature/base/Tag">[[title]]</span>\n\t\t\t\t</span>\n\t\t\t\t<fieldset\n\t\t\t\t\tname   = "${this.getName()}"\n\t\t\t\t\tcv-ref = "input:curvature/base/Tag"\n\t\t\t\t\tcv-expand="attrs"\n\t\t\t\t\tcv-each = "fields:field"\n\t\t\t\t>\n\t\t\t\t\t[[field]]\n\t\t\t\t</fieldset>\n\t\t\t\t<span cv-each = "errors:error:e">\n\t\t\t\t\t<p class = "cv-error">[[error]]</p>\n\t\t\t\t</span>\n\t\t\t</label>\n\t\t`}hasChildren(){return!!Object.keys(this.args.fields).length}wrapSubfield(e){return e}}}),require.register("curvature/form/FileField.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FileField=void 0;var i=t("./Field");e.FileField=class extends i.Field{constructor(e,t,r,i){super(e,t,r,i);var s=this.args.attrs||{};s.type=s.type||this.args.type||"file",this.template=`\n\t\t\t<label\n\t\t\t\tfor       = "${this.getName()}"\n\t\t\t\tdata-type = "${s.type}"\n\t\t\t\tcv-ref    = "label:curvature/base/Tag">\n\t\t\t>\n\t\t\t\t<input\n\t\t\t\t\tname    = "${this.getName()}"\n\t\t\t\t\ttype    = "${s.type}"\n\t\t\t\t\tcv-bind = "value"\n\t\t\t\t\tcv-ref  = "input:curvature/base/Tag"\n\t\t\t\t\tcv-expand = "attrs"\n\t\t\t\t/>\n\t\t\t\t<span style = "display:none" cv-if = "value">[[[value]]]</span>\n\t\t\t\t<span cv-each = "errors:error:e">\n\t\t\t\t\t<p class = "cv-error">[[error]]</p>\n\t\t\t\t</span>\n\t\t\t</label>\n\t\t`}}}),require.register("curvature/form/Form.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Form=void 0;var i=t("../base/View"),s=t("./Field"),n=t("./FieldSet"),a=t("./SelectField"),o=t("./RadioField"),l=t("./HtmlField"),u=t("./HiddenField"),c=t("./ButtonField"),h=t("./TextareaField"),d=t("./multiField/View"),v=t("../base/Bindable");class p extends i.View{constructor(e,t={}){super({}),this.args.flatValue=this.args.flatValue||{},this.args.value=this.args.value||{},this.args.method=e._method||"GET",this.args.classes=this.args.classes||[],this.skeleton=e,this.args.bindTo("classes",e=>{this.args._classes=e.join(" ")}),this.action="",this.template='\n\t\t\t<form\n\t\t\t\tclass     = "[[_classes]]"\n\t\t\t\tmethod    = "[[method]]"\n\t\t\t\tenctype   = "multipart/form-data"\n\t\t\t\tcv-on     = "submit:submit(event)"\n\t\t\t\tcv-ref    = "formTag:curvature/base/Tag"\n\t\t\t\tcv-each   = "fields:field"\n\t\t\t\tcv-expand = "attrs"\n\t\t\t>\n\t\t\t\t[[field]]\n\t\t\t</form>\n\t\t',this.args.fields=p.renderFields(e,this,t),this.fields=this.args.fields;var r=v.Bindable.makeBindable(this);return this.args.bindTo("value",e=>{r.value=e}),this.args.bindTo("valueString",e=>{r.json=e}),r}submit(e){this.args.valueString=JSON.stringify(this.args.value,null,4),this.dispatchEvent(new CustomEvent("submit",{details:{view:this}}))||(e.preventDefault(),e.stopPropagation())}buttonClick(e){}static renderFields(e,t=null,r={}){var i={},f=function(){if(i[m])return 0;if("_"==m.substr(0,1))return 0;var f=null,g=null;if(t&&(g=t instanceof p?t:t.form),r&&e[m].name in r)f=new r[e[m].name](e[m],g,t,m);else switch(e[m].type){case"fieldset":f=e[m].attrs&&e[m].attrs["data-multi"]?new d.View(e[m],g,t,m):new n.FieldSet(e[m],g,t,m);break;case"select":f=new a.SelectField(e[m],g,t,m);break;case"radios":f=new o.RadioField(e[m],g,t,m);break;case"html":f=new l.HtmlField(e[m],g,t,m);break;case"submit":case"button":f=new c.ButtonField(e[m],g,t,m);break;case"hidden":f=new u.HiddenField(e[m],g,t,m);break;case"textarea":f=new h.TextareaField(e[m],g,t,m);break;default:f=new s.Field(e[m],g,t,m)}i[m]=v.Bindable.make(f);var b=f.key;f.args.bindTo("value",(e,r,i,s)=>{if(!isNaN(e)&&null!==e&&e.length&&e==Number(e)&&e.length===String(Number(e)).length&&(e=Number(e)),("html"!=i.type||i.contentEditable)&&"fieldset"!=i.type)if(i.disabled)delete g.args.flatValue[b];else{i.attrs=i.attrs||{};i.attrs.multiple;var n=Array.isArray(e),a=t.args.value[b];if(i.attrs.multiple&&n&&Array.isArray(a))for(var o in e)e[o]!==t.args.value[b][o]&&(t.args.value[b][o]=e[o]),t.args.value[b].splice(e.length);else t.args.value[b]=e;g.args.flatValue[b]=e,g.args.valueString=JSON.stringify(g.args.value,null,4)}}),f.render()};for(var m in e)f();return i}formData(e=null,t=null,r=[]){e||(e=new FormData),t||(t=this);for(var i in t.args.fields)if(!t.args.fields[i]||!t.args.fields[i].disabled){var s=r.slice(0);if(s.push(i),t.args.fields[i]&&t.args.fields[i].hasChildren())this.formData(e,t.args.fields[i],s);else if(t.args.fields[i]){var n=t.args.fields[i].getName();if("file"==t.args.fields[i].args.type&&t.args.fields[i].tags.input.element.files&&t.args.fields[i].tags.input.element.files.length)if(t.args.fields[i].args.attrs.multiple)for(var a=t.args.fields[i].tags.input.element.files,o=0;o<a.length;o++)a[o]&&e.append(n+"[]",a[o]);else t.args.fields[i].tags.input.element.files[0]&&e.append(n,t.args.fields[i].tags.input.element.files[0]);else("file"!==t.args.fields[i].args.type||t.args.fields[i].args.value)&&e.append(n,void 0===t.args.fields[i].args.value?"":t.args.fields[i].args.value)}}return e}queryString(e={}){var t=[];for(var r in this.args.flatValue)e[r]=e[r]||this.args.flatValue[r];for(var i in e)t.push(i+"="+encodeURIComponent(e[i]));return t.join("&")}populate(e){for(var t in e)this.args.value[t]=e[t]}static _updateFields(e,t){for(var r in e.args.fields){var i=e.args.fields[r];t[r]&&(t[r].value&&(i.args.value=t[r].value),t[r].errors&&(i.args.errors=t[r].errors),t[r].title&&(i.args.title=t[r].title),t[r].options&&(i.args.options=t[r].options),t[r].attrs&&(i.args.attrs=t[r].attrs),i.children&&t[r].children&&this._updateFields(i,t[r].children))}}hasChildren(){return!!Object.keys(this.args.fields).length}}e.Form=p}),require.register("curvature/form/HiddenField.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HiddenField=void 0;var i=t("./Field");e.HiddenField=class extends i.Field{constructor(e,t,r,i){e.type="hidden",super(e,t,r,i);var s=this.args.attrs||{};this.args.type=s.type="hidden",this.args.name=s.name=s.name||this.args.name||i,this.template=`\n\t\t\t<label\n\t\t\t\tfor       = "${this.getName()}"\n\t\t\t\tdata-type = "${s.type}"\n\t\t\t\tstyle     = "display:none"\n\t\t\t\tcv-ref    = "label:curvature/base/Tag">\n\t\t\t\t<input\n\t\t\t\t\t\tname      = "${this.getName()}"\n\t\t\t\t\t\ttype      = "hidden"\n\t\t\t\t\t\tcv-bind   = "value"\n\t\t\t\t\t\tcv-ref    = "input:curvature/base/Tag"\n\t\t\t\t\t\tcv-expand = "attrs"\n\t\t\t\t/>\n\t\t\t</label>\n\t\t`}}}),require.register("curvature/form/HtmlField.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.HtmlField=void 0;var i=t("./Field");e.HtmlField=class extends i.Field{constructor(e,t,r,i){super(e,t,r,i),this.key=i,this.args.tagName=this.args.tagName||"div",this.args.displayValue=this.args.value,this.args.attrs=this.args.attrs||{},this.ignore=this.args.attrs["data-cv-ignore"]||!1,this.args.contentEditable=this.args.attrs.contenteditable||!1,this.args.bindTo("value",e=>{this.tags.input&&this.tags.input.element!==document.activeElement&&(this.args.displayValue=e)}),this.template=`<${this.args.tagName}\n\t\t\tname            = "${this.getName()}"\n\t\t\tcv-ref          = "input:curvature/base/Tag"\n\t\t\tcontenteditable = "[[contentEditable]]"\n\t\t\tcv-expand       = "attrs"\n\t\t\tcv-bind         = "$displayValue"\n\t\t\tcv-on           = "input:inputProvided(event);"\n\t\t></${this.args.tagName}>`}inputProvided(e){this.args.value=e.target.innerHTML}hasChildren(){return!1}getName(){return this.key}}}),require.register("curvature/form/RadioField.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RadioField=void 0;var i=t("./Field");e.RadioField=class extends i.Field{constructor(e,t,r,i){super(e,t,r,i);var s=this.args.attrs||{};this.args.name=s.name=s.name||this.args.name||i,this.args.value=this.args.value||"",this.template=`\n\t\t\t<label\n\t\t\t\tfor       = "${this.getName()}"\n\t\t\t\tdata-type = "${s.type}"\n\t\t\t\tcv-ref    = "label:curvature/base/Tag">\n\t\t\t\t<span cv-if = "title">\n\t\t\t\t\t<span cv-ref = "title:curvature/base/Tag">[[title]]</span>\n\t\t\t\t</span>\n\t\t\t\t<span cv-each  = "options:option:optionText"/>\n\t\t\t\t\t<label>\n\t\t\t\t\t\t<input\n\t\t\t\t\t\t\tname      = "${this.args.name}"\n\t\t\t\t\t\t\ttype      = "radio"\n\t\t\t\t\t\t\tvalue     = "[[option]]"\n\t\t\t\t\t\t\tcv-bind   = "value"\n\t\t\t\t\t\t\tcv-expand = "attrs"\n\t\t\t\t\t\t\tcv-on     = "change:changed(event)"\n\t\t\t\t\t/>\n\t\t\t\t\t\t[[optionText]]\n\t\t\t\t\t</label>\n\t\t\t\t</span>\n\t\t\t\t<span cv-each = "errors:error:e">\n\t\t\t\t\t<p class = "cv-error">[[error]]</p>\n\t\t\t\t</span>\n\t\t\t</label>\n\t\t`}getLabel(){for(var e in this.args.options)if(this.args.options[e]==this.args.value)return e}changed(e){this.args.value=e.target.value}postRender(){this.args.bindTo("value",e=>this.selectOptionByValue(e)),this.args.options.bindTo(e=>this.selectOptionByValue(this.args.value),{frame:1})}selectOptionByValue(e){this.findTags("input").forEach(t=>{t.value==e&&(t.checked=!0)})}}}),require.register("curvature/form/SelectField.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SelectField=void 0;var i=t("./Field");e.SelectField=class extends i.Field{constructor(e,t,r,i){super(e,t,r,i);var s=this.args.attrs||{};this.template=`\n\t\t\t<label\n\t\t\t\tfor       = "${this.getName()}"\n\t\t\t\tdata-type = "${s.type||"select"}"\n\t\t\t\tcv-ref    = "label:curvature/base/Tag">\n\t\t\t\t<span cv-if = "title">\n\t\t\t\t\t<span cv-ref = "title:curvature/base/Tag">[[title]]</span>\n\t\t\t\t</span>\n\t\t\t\t<select\n\t\t\t\t\tname      = "${this.getName()}"\n\t\t\t\t\tcv-bind   = "value"\n\t\t\t\t\tcv-each   = "options:option:optionText"\n\t\t\t\t\tcv-ref    = "input:curvature/base/Tag"\n\t\t\t\t\tcv-expand = "attrs"\n\t\t\t\t/>\n\t\t\t\t\t<option value = "[[option]]">[[optionText]]</option>\n\t\t\t\t</select>\n\t\t\t\t<span cv-each = "errors:error:e">\n\t\t\t\t\t<p class = "cv-error">[[error]]</p>\n\t\t\t\t</span>\n\t\t\t</label>\n\t\t`}postRender(){this.args.bindTo("value",e=>this.selectOptionByValue(e)),this.args.options.bindTo(e=>this.selectOptionByValue(this.args.value),{frame:1})}selectOptionByValue(e){var t=this.tags.input.element;for(var r of t.options)r.value==e&&(t.selectedIndex=r.index)}getLabel(){for(var e in this.args.options)if(this.args.options[e]==this.args.value)return e}}}),require.register("curvature/form/TextareaField.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextareaField=void 0;var i=t("./Field");e.TextareaField=class extends i.Field{constructor(e,t,r,i){super(e,t,r,i);var s=this.args.attrs||{};s.type=s.type||"textarea",this.template=`\n\t\t\t<label\n\t\t\t\tfor       = "${this.getName()}"\n\t\t\t\tdata-type = "${s.type}"\n\t\t\t\tcv-ref    = "label:curvature/base/Tag">\n\t\t\t\t<span cv-if = "title">\n\t\t\t\t\t<span cv-ref = "title:curvature/base/Tag">[[title]]</span>\n\t\t\t\t</span>\n\t\t\t\t<textarea\n\t\t\t\t\t\tname      = "${this.getName()}"\n\t\t\t\t\t\tcv-bind   = "value"\n\t\t\t\t\t\tcv-ref    = "input:curvature/base/Tag"\n\t\t\t\t\t\tcv-expand = "attrs"\n\t\t\t\t></textarea>\n\t\t\t\t<cv-template cv-if = "attrs.data-caption">\n\t\t\t\t\t<p>[[attrs.data-caption]]</p>\n\t\t\t\t</cv-template>\n\t\t\t\t<span cv-each = "errors:error:e">\n\t\t\t\t\t<p class = "cv-error">[[error]]</p>\n\t\t\t\t</span>\n\t\t\t</label>\n\t\t`}}}),require.register("curvature/form/multiField/CreateForm.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CreateForm=void 0;var i=t("./FormWrapper");t("../../form/HiddenField");e.CreateForm=class extends i.FormWrapper{constructor(e,t,r="GET",i={}){super(e,t,"POST",i||{}),this.creating=!!e.publicId}onLoad(e){for(var t in e.args.fields)if(e.args.fields[t].tags.input&&"hidden"!=e.args.fields[t].args.attrs.type){e.args.fields[t].tags.input.element.focus();break}super.onLoad(e)}onRequest(){return this.args.view.args.loading=!0,this.args.view.args.classes+=" loading",super.onRequest()}onResponse(e){this.args.view.args.loading=!1,this.args.view.args.classes="",e.body?(this.args.wrapper?this.args.wrapper.refresh(e.body):this.args.view.addRecord(e.body),this.args.view.args.creating="",super.onResponse(e)):super.onResponse(e)}}}),require.register("curvature/form/multiField/Form.js",function(e,t,r){"use strict"}),require.register("curvature/form/multiField/FormWrapper.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FormWrapper=void 0;var i=t("../../base/Repository"),s=t("../../form/Form"),n=t("../../toast/Toast"),a=(t("../../toast/ToastAlert"),t("../../base/View")),o=t("../../base/Router");e.FormWrapper=class extends a.View{constructor(e,t,r="GET",n={}){super(e),this.path=t,this.args.method=r,this.args.action=this.args.action||null,this.args.form=null,this.args.title=null,this.args.class="",this.template='\n\t\t\t<div class = "form constrict [[class]]">\n\t\t\t\t<div cv-if = "title"><label>[[title]]</label></div>\n\t\t\t\t[[form]]\n\t\t\t</div>\n\t\t',this._onLoad=[],this._onSubmit=[],this._onRender=[],this._onRequest=[],this._onError=[],this._onResponse=[],t instanceof s.Form?this.loadForm(form,n):i.Repository.request(t).then(e=>{e&&e.meta&&e.meta.form&&e.meta.form instanceof Object?(this.loadForm(new s.Form(e.meta.form,n)),this.onLoad(this.args.form,e.body)):console.warn("Cannot render form with ",e)})}loadForm(e){this.args.form=e,this.args.form.addEventListener("submit",t=>{t&&(t.preventDefault(),t.stopPropagation());var r=e.tags.formTag.element,s=r.getAttribute("action")||this.args.action||this.path,n=r.getAttribute("method")||this.args.method,a=e.args.flatValue;if("GET"==(n=n.toUpperCase())){var l={};for(var u in this.args.content&&this.args.content.args&&(this.args.content.args.page=0),l.page=0,a)"api"!==u&&(l[u]=a[u]);this.onRequest(l).then(()=>{this.onResponse({}),o.Router.go(s+"?"+o.Router.queryToString(l)),this.update(l)}).catch(e=>{this.onRequestError(e)})}else if("POST"==n){var c=e.formData();for(var h of c.entries());var d=this.onRequest(c);d&&d.then(()=>{i.Repository.request(s,{api:"json"},c,!1,{progressDown:e=>{this.progressDown(e)},progressUp:e=>{this.progressUp(e)}}).then(e=>{this.onResponse(e)}).catch(e=>{this.onRequestError(e)})})}})}onRequest(e){var t=[];for(var r in this._onRequest){var i=this._onRequest[r](e,this);i&&t.push(i)}return 0==t.length?Promise.resolve():Promise.all(t)}onRequestError(e){for(var t in this._onError)this._onError[t](e,this);if(e.messages)for(var r in e.messages)n.Toast.instance().alert(e.body&&e.body.id?"Success!":"Error!",e.messages[r],3500)}onResponse(e){for(var t in this._onResponse)this._onResponse[t](e,this);if(e.messages)for(var r in e.messages)n.Toast.instance().alert(e.body&&e.body.id?"Success!":"Error!",e.messages[r],3500)}onLoad(e,t){for(var r in this._onLoad)this._onLoad[r](this,e,t)}customFields(){return{}}submit(){}progressUp(e){console.log(e.loaded,e.total,e.loaded/e.total)}progressDown(e){console.log(e.loaded,e.total,e.loaded/e.total)}}}),require.register("curvature/form/multiField/SearchForm.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SearchForm=void 0;var i=t("../../base/Config"),s=t("./FormWrapper"),n=t("../../form/HiddenField"),a=t("../../base/Repository"),o=i.Config.get("backend")||"//";e.SearchForm=class extends s.FormWrapper{constructor(e,t,r="GET",i={}){super(e,t,"POST",{search:n.HiddenField}),this.superTemplate=this.template,this.args.records=[],this.selected=null,this.template=`\n\t\t\t${this.superTemplate}\n\t\t\t<div cv-each = "records:record:r" class = "dropdown-results">\n\t\t\t\t<div\n\t\t\t\t\tcv-on         = "click:select(event)"\n\t\t\t\t\tdata-index    = "[[r]]"\n\t\t\t\t\tdata-publicId = "[[record.publicId]]"\n\t\t\t\t\tclass         = "[[record.classes]]"\n\t\t\t\t>\n\t\t\t\t\t[[record.title]]\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`}onLoad(e){for(var t in e.args.fields)if(e.args.fields[t].tags.input&&"hidden"!=e.args.fields[t].args.attrs.type){e.args.fields[t].tags.input.element.focus();break}e.args.flatValue.bindTo("keyword",e=>{this.args.records=[],this.selected=null,e&&(console.log(this.path,e),a.Repository.request(o+this.path,{keyword:e}).then(t=>{console.log(t.body),t.body&&(this.args.records=t.body.map(t=>(t.classes="",t.title==e&&(t.classes="selected",this.selected=t),t)))}))}),super.onLoad(e)}onRequest(){return super.onRequest()}onResponse(e){super.onResponse(e)}select(e){var t=e.target.getAttribute("data-index"),r=(e.target.getAttribute("data-publicId"),this.args.records[t]);console.log(r),this.args.view.addRecord(r),this.args.view.addButtonClicked()}onSubmit(e,t){return t.preventDefault(),t.stopPropagation(),this.selected&&(this.args.view.addRecord(this.selected),this.args.view.addButtonClicked()),!1}}}),require.register("curvature/form/multiField/View.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.View=void 0;var i=t("../../base/Config"),s=t("../../form/Form"),n=t("../../form/FieldSet"),a=t("./CreateForm"),o=t("./SearchForm"),l=(t("./FormWrapper"),t("./Wrapper"));e.View=class extends n.FieldSet{constructor(e,t,r,i){for(var s in super(e,t,r,i),this.args._fields=[],this.dragging=!1,this.dropping=!1,this.args.fields)this.args._fields[Number(s)+1]=this.wrapSubfield(this.args.fields[s]);this.args.fields[-1].disable(),this.args._fields[0].addEventListener("attach",e=>e.preventDefault()),this.args.creating="",this.args.fieldType="",this.args.createForm=this.args.createForm||"",this.args.searchForm=this.args.searchForm||"",this.args.createFormReady=!1,this.setCreateForm({view:this}),this.args.loader="...",this.args.addIcon="&#215;",this.args.addIcon="a",this.args.addIcon="+",this.args.draggable="true",this.template=`\n\t\t\t<label\n\t\t\t\tfor        = "${this.args.name}"\n\t\t\t\tdata-type  = "${this.args.attrs.type}"\n\t\t\t\tdata-multi = "${this.args.attrs["data-multi"]?"true":"false"}"\n\t\t\t>\n\t\t\t\t<span cv-if = "title">\n\t\t\t\t\t<span cv-ref = "title:curvature/base/Tag">[[title]]</span>\n\t\t\t\t</span>\n\n\t\t\t\t<fieldset\n\t\t\t\t\tname  = "${this.args.name}"\n\t\t\t\t\tclass = "multi-field [[creating]] [[fieldType]]"\n\t\t\t\t>\n\n\t\t\t\t\t<div class = "record-list" cv-each = "_fields:field:f">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclass     = "single-record"\n\t\t\t\t\t\t\tdata-for  = "[[f]]"\n\t\t\t\t\t\t>[[field]]</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class = "overlay create">\n\t\t\t\t\t\t<div class = "form constrict">\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tcv-on = "click:addButtonClicked(event)"\n\t\t\t\t\t\t\t\tclass = "bubble bottom left-margin close"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t&#215;\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t[[createForm]]\n\t\t\t\t\t\t[[searchForm]]\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class = "overlay loading">\n\t\t\t\t\t\t[[loader]]\n\t\t\t\t\t</div>\n\t\t\t\t\t<div cv-if = "createFormReady" class="add-button-holder">\n\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tcv-on = "click:addButtonClicked(event)"\n\t\t\t\t\t\t\tclass = "bubble bottom left-margin add"\n\t\t\t\t\t\t\ttab-index = "0"\n\t\t\t\t\t\t>[[addIcon]]</div>\n\n\t\t\t\t\t</div>\n\n\t\t\t\t</fieldset>\n\n\t\t\t\t<span cv-each = "errors:error:e">\n\t\t\t\t\t<p class = "cv-error">[[error]]</p>\n\t\t\t\t</span>\n\n\t\t\t</label>\n\t\t`}setCreateForm(e){var t="";i.Config.get("backend")&&(t=i.Config.get("backend")),!1!==this.args.attrs["data-create-endpoint"]&&void 0!==this.args.attrs["data-create-endpoint"]?(this.args.createForm=new a.CreateForm(Object.assign({},e),this.args.attrs["data-create-endpoint"]?t+this.args.attrs["data-create-endpoint"]:e.publicId?t+`${this.args.attrs["data-endpoint"]}/${e.publicId}/edit`:t+`${this.args.attrs["data-endpoint"]}/create`),this.args.createForm._onLoad.push((e,t)=>{this.args.createFormReady=!0})):this.args.createFormReady=!0,this.args.attrs["data-endpoint"]&&(this.args.searchForm=new o.SearchForm(Object.assign({},e),t+this.args.attrs["data-endpoint"]))}wrapSubfield(e){return new l.Wrapper({field:e,parent:this})}addButtonClicked(){this.args.creating||(this.args.creating="creating")}addRecord(e){for(var t in this.args.creating="",Array.isArray(e)||(e=[e]),e){this.args.fields[-1].constructor;var r,i=Object.assign({},this.args.fields[-1].skeleton),n=Object.values(this.args.fields).length-1;i=this.cloneSkeleton(i),(i=this.correctNames(i,n)).attrs=null!==(r=i.attrs)&&void 0!==r?r:{},i.attrs["data-array"]=!0;var a={};a[n]=i;var o=s.Form.renderFields(a,this)[n];this.args.fields[n]=o;var l=this.wrapSubfield(o);o.args.value.id=e[t].id||"",o.args.value.class=e[t].class||"",o.args.value.title=e[t].title||"",o.args.value.key=this.args._fields.length,console.log(this.args._fields),this.args._fields.push(l),l.refresh(e[t])}}editRecord(e,t){this.setCreateForm({view:this,publicId:e.publicId,wrapper:t}),this.args.creating=this.args.creating?"":"creating"}deleteImage(e){console.log(e,this.args.fields),this.args.fields[e].disable(),this.args._fields[e].args.classes="deleted"}undeleteImage(e){this.args.fields[e].enable(),this.args._fields[e].args.classes=""}cloneSkeleton(e,t=0){var r={};for(var i in Array.isArray(e)&&(r=[]),e)"fields"!=i&&(e[i]&&"object"==typeof e[i]?r[i]=Object.assign({},this.cloneSkeleton(e[i],t+1)):r[i]=e[i]);return r}correctNames(e,t){if(e.name=e.name.replace(/\[-1\]/,`[${t}]`),e.attrs.name=e.name,"children"in e)for(var r in e.children)e.children[r]=this.correctNames(e.children[r],t);return e}drag(e){this.dragging=e.target}dragOver(e){if(!this.dragging)return!1;for(var t=e.target;t&&!t.matches('[draggable="true"]');)t=t.parentNode;t&&(this.dropping=t,e.preventDefault())}drop(e){e.stopPropagation();var t=this.dragging.querySelector("label"),r=this.dropping.querySelector("label"),i=t.getAttribute("for"),s=r.getAttribute("for"),n=this.extractIndex(i),a=this.extractIndex(s);if(n==a||n==a-1)return this.dragging=!1,void(this.dropping=!1);var o,l,u=t.querySelectorAll('[name^="'+i+'"]'),c=t.querySelectorAll('[for^="'+i+'"]'),h=r.querySelectorAll('[name^="'+s+'"]'),d=r.querySelectorAll('[for^="'+s+'"]'),v=this.dropping,p=0;for(var f in this.args.fields){var m=this.args.fields[f].tags.input.element,g=this.args.fields[f].tags.label.element,b=m.getAttribute("name");t==g&&(o=this.args.fields[f]),r==g&&(l=this.args.fields[f]);var y=this.extractIndex(b),w=!1;if(!(y<0)&&(n>a&&y>=a&&y<=n?(w=this.changeIndex(b,y+1),p=-1):n<a&&y<=a&&y>=n&&(w=this.changeIndex(b,y-1),p=0),!1!==w)){this.changeAttributePrefix(g,"for",b,w),this.args.fields[f].args.fieldName=w,this.changeAttributePrefix(m,"name",b,w);for(var j=m.parentNode.querySelectorAll('[name^="'+b+'"]'),E=0;E<j.length;E++)this.changeAttributePrefix(j[E],"name",b,w);for(var P=m.parentNode.querySelectorAll('[for^="'+b+'"]'),_=0;_<P.length;_++)this.changeAttributePrefix(P[_],"for",b,w)}}i=t.getAttribute("for"),s=r.getAttribute("for"),n=this.extractIndex(i),a=this.extractIndex(s),this.changeAttributePrefix(t,"for",i,this.changeIndex(i,a+p));for(var T=0;T<u.length;T++)this.changeAttributePrefix(u[T],"name",i,this.changeIndex(i,a+p));for(var S=0;S<c.length;S++)this.changeAttributePrefix(c[S],"for",i,this.changeIndex(i,a+p));o.args.fieldName=t.getAttribute("for"),this.changeAttributePrefix(r,"for",s,this.changeIndex(s,a+p+1));for(var O=0;O<h.length;O++)this.changeAttributePrefix(h[O],"name",s,this.changeIndex(s,a+p+1));for(var C=0;C<d.length;C++)this.changeAttributePrefix(d[C],"for",s,this.changeIndex(s,a+p+1));l.args.fieldName=r.getAttribute("for"),this.dragging.parentNode.insertBefore(this.dragging,v),this.dragging=!1,this.dropping=!1}dragStop(){this.dragging=!1,this.dropping=!1}changeAttributePrefix(e,t,r,i){e.getAttribute(t);var s=i+e.getAttribute(t).substring(r.length);e.setAttribute(t,s)}extractIndex(e){var t;return!!(t=/\[(-?\d+)\]$/.exec(e))&&parseInt(t[1])}changeIndex(e,t){return e.replace(/\[(-?\d+)\]$/,"["+t+"]")}cancel(e){e.stopPropagation()}}}),require.register("curvature/form/multiField/Wrapper.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Wrapper=void 0;var i=t("../../base/Config"),s=t("../../base/View"),n=t("../../base/Repository");e.Wrapper=class extends s.View{constructor(e){super(e),this.template='\n\t\t\t<div\n\t\t\t\tclass = "wrapped-field [[classes]]"\n\t\t\t\tcv-on = "click:editRecord(event, key)"\n\t\t\t\ttitle = "[[fieldName]]: [[id]]"\n\t\t\t>\n\t\t\t\t<div\n\t\t\t\t\tcv-on = "click:deleteImage(event, key)"\n\t\t\t\t\tstyle = "display: inline; cursor:pointer;"\n\t\t\t\t>\n\t\t\t\t\t[[icon]]\n\t\t\t\t</div>\n\t\t\t\t<div class = "field-content">\n\t\t\t\t\t[[title]]\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div style = "display:none">[[field]]</div>\n\t\t',this.args.field=this.args.field||"!",this.args.keyword="",this.args.title="",this.args.record={},this.args.key=this.args.field.key,this.args.classes="",this.args.icon="",this.deleted=!1,this.args.field.args.bindTo("fieldName",e=>{this.args.fieldName=e}),this.args.fieldName=this.args.field.args.name,this.args.id=this.args.field.args.value.id,this.args.bindTo("id",e=>{this.args.field.args.value.id=e}),this.args.field.args.value.bindTo("id",(e,t)=>{e&&n.Repository.request(this.backendPath(),{id:e}).then(t=>{this.args.id=e;var r=t.body[0];if(!r)return this.args.publicId=null,void(this.args.title=null);this.refresh(r)})},{wait:0}),this.args.field.args.value.bindTo("keyword",e=>{this.args.keyword=e})}editRecord(){this.args.parent.editRecord(this.args.record,this)}deleteImage(e,t){e.stopPropagation(),this.deleted?(this.args.icon="",this.args.parent.undeleteImage(t),this.deleted=!1):(this.args.icon="",this.args.parent.deleteImage(t),this.deleted=!0)}backendPath(){return(i.Config.get("backend")||"//")+this.args.parent.args.attrs["data-endpoint"]}getRecordTitle(e){return e._titleField?e[e._titleField]:e.title||e.publicId||e.id}refresh(e){for(var t in e)this.args[t]=e[t];this.args.record=e,this.args.title=this.getRecordTitle(e)}}}),require.register("curvature/input/Axis.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Axis=void 0;var i,s=t("../base/Bindable");function n(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}i=s.Bindable.NoGetters;e.Axis=class{constructor({deadZone:e=0,proportional:t=!0}){n(this,i,!0),n(this,"magnitude",0),n(this,"delta",0),this.proportional=t,this.deadZone=e}tilt(e){this.deadZone&&Math.abs(e)>=this.deadZone?e=(Math.abs(e)-this.deadZone)/(1-this.deadZone)*Math.sign(e):this.deadZone&&Math.abs(e)<this.deadZone&&(e=0),this.delta=Number(e-this.magnitude).toFixed(3)-0,this.magnitude=Number(e).toFixed(3)-0}zero(){this.magnitude=this.delta=0}}}),require.register("curvature/input/Button.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Button=void 0;var i,s=t("../base/Bindable");function n(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}i=s.Bindable.NoGetters;e.Button=class{constructor(){n(this,i,!0),n(this,"active",!1),n(this,"pressure",0),n(this,"delta",0),n(this,"time",0)}update(e={}){this.pressure?this.time++:!this.pressure&&this.time>0?this.time=-1:!this.pressure&&this.time<0&&this.time--,this.time<-1&&-1===this.delta&&(this.delta=0)}press(e){this.delta=Number(e-this.pressure).toFixed(3)-0,this.pressure=Number(e).toFixed(3)-0,this.active=!0,this.time=this.time>0?this.time:0}release(){this.active&&(this.delta=Number(-this.pressure).toFixed(3)-0,this.pressure=0,this.active=!1)}zero(){this.pressure=this.delta=0,this.active=!1}}}),require.register("curvature/input/Gamepad.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Gamepad=void 0;var i,s=t("../base/Bindable"),n=t("../base/Mixin"),a=t("../mixin/EventTargetMixin"),o=t("./Axis"),l=t("./Button");function u(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var c={Space:0,Enter:0,NumpadEnter:0,ControlLeft:1,ControlRight:1,ShiftLeft:2,ShiftRight:2,KeyZ:3,KeyQ:4,KeyE:5,Digit1:6,Digit3:7,KeyW:12,KeyA:14,KeyS:13,KeyD:15,KeyH:112,KeyJ:113,KeyK:114,KeyL:115,KeyP:9,Pause:9,Tab:11,ArrowUp:12,ArrowDown:13,ArrowLeft:14,ArrowRight:15,Numpad4:112,Numpad2:113,Numpad8:114,Numpad6:115,Backquote:1010,NumpadAdd:1011,NumpadSubtract:1012,NumpadMultiply:1013,NumpadDivide:1014,Escape:1020};[...Array(12)].map((e,t)=>c[`F${t}`]=2e3+t),i=s.Bindable.NoGetters;class h extends(n.Mixin.with(a.EventTargetMixin)){static getPad({index:e,deadZone:t=0,keys:r={},keyboard:i=null,axisMap:s=null}){if(this.padsConnected.has(e))return this.padsConnected.get(e);var n=new Promise(e=>{addEventListener("gamepadconnected",a=>{a.stopImmediatePropagation();var o=new this({gamepad:a.gamepad,deadZone:t,keys:r,keyboard:i,axisMap:s});this.padsConnected.set(a.gamepad.index,n),e(o)},{once:!0})});return n}constructor({keys:e={},deadZone:t=0,gamepad:r=null,keyboard:s=null,axisMap:n=null}={}){super(),u(this,i,!0),u(this,"axisMap",{12:-1,13:1,14:-0,15:0,112:-2,113:3,114:-3,115:2}),this.deadZone=t,this.gamepad=r,this.index=r.index,this.id=r.id,this.axisMap=n||this.axisMap,Object.defineProperties(this,{buttons:{value:{}},pressure:{value:{}},axes:{value:{}},keys:{value:{}}})}update(){for(var e in this.buttons){this.buttons[e].update()}}rumbleEffect(e){return this.gamepad.vibrationActuator.playEffect("dual-rumble",e)}rumble(...e){if(this.gamepad.vibrationActuator.pulse)return this.gamepad.vibrationActuator.pulse(...e);this.rumbleEffect({duration:1e3,strongMagnitude:1,weakMagnitude:1})}readInput(){if(this.gamepad){var e=String(this.gamepad.index),t=this.constructor;t.padsRead.has(e)||(t.padsRead=new Map(Object.entries(navigator.getGamepads())));var r=this.gamepad=t.padsRead.get(e);t.padsRead.delete(e);var i={},s={};if(r)for(var n in r.buttons){var a=r.buttons[n];a.pressed&&(this.press(n,a.value),i[n]=!0)}if(this.keyboard){for(var o in[...Array(10)])i[o]||this.keyboard.getKeyCode(o)>0&&(this.press(o,1),i[o]=!0);for(var u in c)if(!i[u]){var h=c[u];this.keyboard.getKeyCode(u)>0&&(this.press(h,1),i[h]=!0)}}if(r)for(var d in r.buttons){if(!i[d])r.buttons[d].pressed||(this.release(d),s[d]=!0)}if(this.keyboard){for(var v in[...Array(10)])s[v]||i[v]||this.keyboard.getKeyCode(v)<0&&(this.release(v),s[v]=!0);for(var p in c){var f=c[p];s[f]||(i[f]||this.keyboard.getKeyCode(p)<0&&(this.release(f),s[p]=!0))}}var m={};if(r)for(var g in r.axes){var b=r.axes[g];m[g]=!0,this.tilt(g,b)}for(var y in this.axisMap){this.buttons[y]||(this.buttons[y]=new l.Button);var w=this.axisMap[y],j=Math.sign(1/w),E=Math.abs(w);this.buttons[y].active?(m[E]=!0,this.tilt(E,j)):m[E]||this.tilt(E,0)}}}tilt(e,t){this.axes[e]||(this.axes[e]=new o.Axis({deadZone:this.deadZone})),this.axes[e].tilt(t)}press(e,t=1){this.buttons[e]||(this.buttons[e]=new l.Button),this.buttons[e].press(t)}release(e){this.buttons[e]||(this.buttons[e]=new l.Button),this.buttons[e].release()}serialize(){var e={};for(var t in this.buttons)e[t]=this.buttons[t].pressure;var r={};for(var i in this.axes)r[i]=this.axes[i].magnitude;return{axes:r,buttons:e}}replay(e){if(e.buttons)for(var t in e.buttons)e.buttons[t]>0?this.press(t,e.buttons[t]):this.release(t);if(e.axes)for(var r in e.axes)e.axes[r].magnitude!==e.axes[r]&&this.tilt(r,e.axes[r])}zero(){for(var e in this.axes)this.axes[e].zero();for(var t in this.buttons)this.buttons[t].zero()}}e.Gamepad=h,u(h,"padsConnected",new Map),u(h,"padsRead",new Map)}),require.register("curvature/input/Keyboard.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Keyboard=void 0;var i=t("../base/Bindable");e.Keyboard=class{static get(){return this.instance=this.instance||i.Bindable.make(new this)}constructor(){this.maxDecay=120,this.comboTime=500,this.listening=!1,this.focusElement=document.body,this[i.Bindable.NoGetters]=!0,Object.defineProperty(this,"combo",{value:i.Bindable.make([])}),Object.defineProperty(this,"whichs",{value:i.Bindable.make({})}),Object.defineProperty(this,"codes",{value:i.Bindable.make({})}),Object.defineProperty(this,"keys",{value:i.Bindable.make({})}),Object.defineProperty(this,"pressedWhich",{value:i.Bindable.make({})}),Object.defineProperty(this,"pressedCode",{value:i.Bindable.make({})}),Object.defineProperty(this,"pressedKey",{value:i.Bindable.make({})}),Object.defineProperty(this,"releasedWhich",{value:i.Bindable.make({})}),Object.defineProperty(this,"releasedCode",{value:i.Bindable.make({})}),Object.defineProperty(this,"releasedKey",{value:i.Bindable.make({})}),Object.defineProperty(this,"keyRefs",{value:i.Bindable.make({})}),document.addEventListener("keyup",e=>{this.listening&&(this.keys[e.key]>0||!this.focusElement||document.activeElement===this.focusElement||this.focusElement.contains(document.activeElement)&&!document.activeElement.matches("input,textarea"))&&(e.preventDefault(),this.releasedWhich[e.which]=Date.now(),this.releasedCode[e.code]=Date.now(),this.releasedKey[e.key]=Date.now(),this.whichs[e.which]=-1,this.codes[e.code]=-1,this.keys[e.key]=-1)}),document.addEventListener("keydown",e=>{this.listening&&(!this.focusElement||document.activeElement===this.focusElement||this.focusElement.contains(document.activeElement)&&!document.activeElement.matches("input,textarea"))&&(e.preventDefault(),e.repeat||(this.combo.push(e.code),clearTimeout(this.comboTimer),this.comboTimer=setTimeout(()=>this.combo.splice(0),this.comboTime),this.pressedWhich[e.which]=Date.now(),this.pressedCode[e.code]=Date.now(),this.pressedKey[e.key]=Date.now(),this.keys[e.key]>0||(this.whichs[e.which]=1,this.codes[e.code]=1,this.keys[e.key]=1)))});var e=e=>{for(var t in this.keys)this.keys[t]<0||(this.releasedKey[t]=Date.now(),this.keys[t]=-1);for(var r in this.codes)this.codes[r]<0||(this.releasedCode[r]=Date.now(),this.codes[r]=-1);for(var i in this.whichs)this.whichs[i]<0||(this.releasedWhich[i]=Date.now(),this.whichs[i]=-1)};window.addEventListener("blur",e),window.addEventListener("visibilitychange",()=>{"visible"!==document.visibilityState&&e()})}getKeyRef(e){return this.keyRefs[e]=this.keyRefs[e]||i.Bindable.make({})}getKeyTime(e){var t=this.releasedKey[e],r=this.pressedKey[e];return r?!t||t<r?Date.now()-r:-1*(Date.now()-t):0}getCodeTime(e){var t=this.releasedCode[e],r=this.pressedCode[e];return r?!t||t<r?Date.now()-r:-1*(Date.now()-t):0}getWhichTime(e){var t=this.releasedWhich[e],r=this.pressedWhich[e];return r?!t||t<r?Date.now()-r:-1*(Date.now()-t):0}getKey(e){return this.keys[e]?this.keys[e]:0}getKeyCode(e){return this.codes[e]?this.codes[e]:0}reset(){for(var e in this.keys)delete this.keys[e];for(var e in this.codes)delete this.codes[e];for(var e in this.whichs)delete this.whichs[e]}update(){for(var e in this.keys)this.keys[e]>0?this.keys[e]++:this.keys[e]>-this.maxDecay?this.keys[e]--:delete this.keys[e];for(var e in this.codes){var t=this.releasedCode[e],r=this.pressedCode[e],i=this.getKeyRef(e);if(this.codes[e]>0){if(i.frames=this.codes[e]++,i.time=r?Date.now()-r:0,i.down=!0,!t||t<r)return;return-1*(Date.now()-t)}this.codes[e]>-this.maxDecay?(i.frames=this.codes[e]--,i.time=t-Date.now(),i.down=!1):(i.frames=0,i.time=0,i.down=!1,delete this.codes[e])}for(var e in this.whichs)this.whichs[e]>0?this.whichs[e]++:this.whichs[e]>-this.maxDecay?this.whichs[e]--:delete this.whichs[e]}}}),require.register("curvature/input/Mouse.js",function(e,t,r){"use strict"}),require.register("curvature/input/Sequence.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Sequence=void 0;var i,s=t("../base/Bindable"),n=t("../base/Mixin"),a=t("../mixin/EventTargetMixin");function o(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}i=s.Bindable.NoGetters;e.Sequence=class extends(n.Mixin.with(a.EventTargetMixin)){constructor({callback:e,keys:t,timing:r,gamepad:s}){super(),o(this,i,!0),o(this,"lastTap",!1),o(this,"recent",[]),o(this,"callback",()=>{}),o(this,"timing",500),o(this,"keys",""),[this.callback,this.timing,this.keys,this.gamepad]=[e,r,t,s]}check(e){var t=this.recent,r=Date.now();r+-this.lastTap>this.timing&&t.splice(0),t.push({code:e,time:Date.now()});var i=t.map(e=>e.code).join(","),s=this.keys.join(",");this.lastTap=r;var n=[];for(var a in t){t[a];var o=t.slice(a),l=o.map(e=>e.code).join(",");if(l===s.substr(0,l.length)){n.push(...o),this.dispatchEvent(new CustomEvent("advance",{detail:{matched:n,recent:t,keys:this.keys,length:o.length}}));break}}n.length?s===i.substr(-s.length)&&this.dispatchEvent(new CustomEvent("complete",{detail:{matched:n,recent:t,keys:this.keys,length:n.length}})):this.dispatchEvent(new CustomEvent("cancel",{detail:{matched:n,recent:t,keys:this.keys,length:n.length}}))}}}),require.register("curvature/mixin/EventTargetMixin.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EventTargetMixin=void 0;var i=t("../base/Mixin"),s=Symbol("EventTargetParent"),n=Symbol("CallHandler"),a=Symbol("Capture"),o=Symbol("Bubble"),l=(Symbol("Target"),Symbol("HandlersBubble")),u=Symbol("HandlersCapture"),c=e.EventTargetMixin={[i.Mixin.Constructor](){this[u]=new Map,this[l]=new Map},dispatchEvent(...e){var t=e[0];"string"==typeof t&&(t=new CustomEvent(t),e[0]=t),t.cvPath=t.cvPath||[],t.cvTarget=t.cvCurrentTarget=this;var r=this[a](...e);if(t.cancelable&&(!1===r||t.cancelBubble))return r;var i=[];if(this[u].has(t.type)){var c=this[u].get(t.type),h=[...c];h.forEach(e=>e.push(c)),i.push(...h)}if(this[l].has(t.type)){var d=this[l].get(t.type),v=[...d];v.forEach(e=>e.push(d)),i.push(...v)}for(var[p,f,m]of(i.push([()=>this[n](...e),{},null]),i))if(f.once&&m.delete(p),r=p(t),t.cancelable&&!1===r)break;return t.cancelable&&(t.cancelBubble||!1===r)||this[o](...e),this[s]||Object.freeze(t.cvPath),t.returnValue},addEventListener(e,t,r={}){!0===r&&(r={useCapture:!0});var i=l;r.useCapture&&(i=u),this[i].has(e)||this[i].set(e,new Map),this[i].get(e).set(t,r),r.signal&&r.signal.addEventListener("abort",i=>this.removeEventListener(e,t,r),{once:!0})},removeEventListener(e,t,r={}){!0===r&&(r={useCapture:!0});var i=l;r.useCapture&&(i=u),this[i].has(e)&&this[i].get(e).delete(t)},[a](...e){var t=e[0];if(t.cvPath.push(this),this[s]){var r=this[s][a](...e);if((!t.cancelable||!1!==r&&!t.cancelBubble)&&this[s][u].has(t.type)){t.cvCurrentTarget=this[s];var{type:i}=t,n=this[s][u].get(i);for(var[o,l]of n)if(l.once&&n.delete(o),r=o(t),t.cancelable&&(!1===r||t.cancelBubble))break;return r}}},[o](...e){var t=e[0];if(t.bubbles&&this[s]&&!t.cancelBubble){if(!this[s][l].has(t.type))return this[s][o](...e);var r;t.cvCurrentTarget=this[s];var{type:i}=t,a=this[s][l].get(t.type);for(var[u,c]of a)if(c.once&&a.delete(u),r=u(t),t.cancelable&&!1===r)return r;return r=this[s][n](...e),t.cancelable&&(!1===r||t.cancelBubble)?r:this[s][o](...e)}},[n](...e){var t=e[0];if(!t.defaultPrevented){var r=`on${t.type[0].toUpperCase()+t.type.slice(1)}`;return"function"==typeof this[r]?this[r](t):void 0}}};Object.defineProperty(c,"Parent",{value:s})}),require.register("curvature/mixin/PromiseMixin.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PromiseMixin=void 0;var i=t("../base/Mixin"),s=Symbol("Promise"),n=Symbol("Accept"),a=Symbol("Reject"),o=e.PromiseMixin={[i.Mixin.Constructor](){this[s]=new Promise((e,t)=>{this[n]=e,this[a]=t})},then(...e){return this[s].then(...e)},catch(...e){return this[s].catch(...e)},finally(...e){return this[s].finally(...e)}};Object.defineProperty(o,"Reject",{value:a}),Object.defineProperty(o,"Accept",{value:n})}),require.register("curvature/model/Database.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Database=void 0;var i=t("../base/Bindable"),s=t("../base/Mixin"),n=t("../mixin/EventTargetMixin"),a=Symbol("BeforeWrite"),o=Symbol("AfterWrite"),l=Symbol("BeforeDelete"),u=Symbol("AfterDelete"),c=Symbol("BeforeInsert"),h=Symbol("AfterInsert"),d=Symbol("BeforeUpdate"),v=Symbol("AfterUpdate"),p=Symbol("BeforeRead"),f=Symbol("AfterRead"),m=Symbol("PrimaryKey"),g=Symbol("Connection"),b=Symbol("Instances"),y=(Symbol("HighWater"),Symbol("Metadata")),w=Symbol("Timers"),j=Symbol("Target"),E=(Symbol("Store"),Symbol("Each")),P=Symbol("Name"),_=Symbol("Bank");class T extends(s.Mixin.with(n.EventTargetMixin)){constructor(e){super(),Object.defineProperty(this,g,{value:e}),Object.defineProperty(this,P,{value:e.name}),Object.defineProperty(this,w,{value:{}}),Object.defineProperty(this,y,{value:{}}),Object.defineProperty(this,_,{value:{}})}static open(e,t=0){return this[b][e]?this[b][e]:this[b][e]=new Promise((r,i)=>{var s=indexedDB.open(e,t);s.onerror=(e=>{T.dispatchEvent(new CustomEvent("error",{detail:{database:this[P],error:e,store:void 0,type:"read",subType:"select"}})),i(e)}),s.onsuccess=(e=>{var t=new this(e.target.result);r(t)}),s.onupgradeneeded=(e=>{var r=e.target.result;r.addEventListener("error",e=>console.error(e));for(var i=new this(r),s=e.oldVersion+1;s<=t;s+=1)i["_version_"+s](r,i,e)})})}select({store:e,index:t,range:r,ranges:i=[],direction:s="next",limit:n=0,offset:a=0,type:o=!1,origin:l,map:u}){var c=this[g].transaction(e,"readonly").objectStore(e),h=t?c.index(t):c;void 0===r||i&&i.length||(i=[r]);var d=[o,h,s,i,n,a,l,u],v=null;return{finally:e=>(v||(v=this[E](...d)(e=>e))).finally(e),catch:e=>(v||(v=this[E](...d)(e=>e))).catch(e),then:e=>(v||(v=this[E](...d)(e=>e))).then(e),each:e=>v||(v=this[E](...d)(e)),one:e=>v||(v=this[E](...Object.assign(d,[,,,,1]))(e))}}insert(e,t,r={}){return this.inserts({[e]:t},r)[0]}inserts(e,t={}){var r=this,s=Object.keys(e),n=this[g].transaction(s,"readwrite"),a=[],o=function(e){var s=n.objectStore(e),o=r[_][e]=r[_][e]||{},l=!0;Array.isArray(u)||(u=[u],l=!1);var c,h=u.map(a=>new Promise((l,u)=>{a=i.Bindable.make(a);var c={database:r,record:a,store:e,type:"write",subType:"insert",origin:t};c.key=T.getPrimaryKey(a);var h=new CustomEvent("write",{cancelable:!0,detail:c});if(r.dispatchEvent(h)){var d=a[T.BeforeWrite]?a[T.BeforeWrite](c):null,v=a[T.BeforeInsert]?a[T.BeforeInsert](c):null,p=s.add(Object.assign({},i.Bindable.shuck(a)));!1!==d&&!1!==v?(p.onerror=(e=>{r.dispatchEvent(new CustomEvent("writeError",{detail:c})),n.abort&&n.abort(),u(e)}),p.onsuccess=(i=>{var u=i.target.result;n.addEventListener("complete",i=>{if(s.autoIncrement&&(a.id=u),a[T.AfterInsert]&&a[T.AfterInsert](c),a[T.AfterWrite]&&a[T.AfterWrite](c),o[u]=a,a[m]=Symbol.for(u),l(a),r[y][e]||(r[y][e]=r.getStoreMeta(e,"store",{})),r[y][e]){var n=r.checkHighWaterMark(e,a),h=r.checkLowWaterMark(e,a),d=r[y][e],v=a[d.highWater];t.setHighWater&&n<v&&r.setHighWaterMark(e,a,t,"insert"),t.setLowWater&&h>v&&r.setLowWaterMark(e,a,t,"insert")}})})):n.abort&&n.abort()}else n.abort&&n.abort()}));c=l?Promise.all(h):h[0],a.push(c)};for(var[l,u]of Object.entries(e))o(l);return a}update(e,t,r={}){return this.updates({[e]:[t]},r)[0]}updates(e,t={}){var r=this,s=Object.keys(e),n=this[g].transaction(s,"readwrite"),a=[],o=function(e){var s=n.objectStore(e),o=function(o){if(!o[m])throw Error("Value provided is not a DB record!");a.push(new Promise((a,l)=>{var u={database:r,key:T.getPrimaryKey(o),record:o,store:e,type:"write",subType:"update",origin:t},c=new CustomEvent("write",{cancelable:!0,detail:u});if(r.dispatchEvent(c)){var h=o[T.BeforeWrite]?o[T.BeforeWrite](u):null,d=o[T.BeforeUpdate]?o[T.BeforeUpdate](u):null;if(!1!==h&&!1!==d){var v=s.delete(o.id);v.onerror=(e=>{r.dispatchEvent(new CustomEvent("writeError",{detail:u})),l(e)}),v.onsuccess=(h=>{var d=s.put(Object.assign({},i.Bindable.shuck(o)));d.onerror=(e=>{r.dispatchEvent(new CustomEvent("writeError",{detail:u})),l(e)}),d.onsuccess=(i=>{a(c),n.oncomplete=(i=>{if(o[T.AfterInsert]&&o[T.AfterInsert](u),o[T.AfterWrite]&&o[T.AfterWrite](u),r[y][e]||(r[y][e]=r.getStoreMeta(e,"store",{})),r[y][e]){var s=r.checkHighWaterMark(e,o),n=r.checkLowWaterMark(e,o),a=r[y][e],l=o[a.highWater];t.setHighWater&&s<l&&r.setHighWaterMark(e,o,t,"insert"),t.setLowWater&&n>l&&r.setLowWaterMark(e,o,t,"insert")}})})})}else n.abort&&n.abort()}else n.abort&&n.abort()}))};for(var l of u)o(l)};for(var[l,u]of Object.entries(e))o(l);return Promise.all(a).then(()=>n.commit&&n.commit()),a}delete(e,t,r={}){return this.deletes({[e]:[t]},r)[0]}deletes(e,t={}){var r=this,i=Object.keys(e),s=this[g].transaction(i,"readwrite"),n=[],a=function(e){var i=s.objectStore(e),a=function(a){if(!a[m])throw Error("Value provided is not a DB record!");n.push(new Promise((n,o)=>{var l={database:r,record:a,key:T.getPrimaryKey(a),store:e,type:"write",subType:"delete",origin:t},u=new CustomEvent("write",{cancelable:!0,detail:l});if(r.dispatchEvent(u))if(!1!==(a[T.BeforeDelete]?a[T.BeforeDelete](l):null)){var c=i.delete(a.id);c.onerror=(e=>{l.original=e;var t=new CustomEvent("writeError",{detail:l});r.dispatchEvent(t),o(e)}),c.onsuccess=(e=>{n(u),s.oncomplete=(e=>{a[m]=void 0,a[T.AfterDelete]&&a[T.AfterDelete](l),l.original=e})})}else s.abort&&s.abort();else s.abort&&s.abort()}))};for(var o of l)a(o)};for(var[o,l]of Object.entries(e))a(o);return Promise.all(n).then(()=>s.commit&&s.commit()),n}clear(e){return new Promise((t,r)=>{var i=this[g].transaction([e],"readwrite"),s=i.objectStore(e).clear(),n={database:this[P],store:e,type:"write",subType:"clear",origin:origin};s.onerror=(e=>{n.original=e;var t=new CustomEvent("writeError",{detail:n});this.dispatchEvent(t),r(e)}),s.onsuccess=(e=>{n.original=e;var r=new CustomEvent("write",{detail:n});this.dispatchEvent(r),i.commit&&i.commit(),t(r)})})}listStores(){return[...this[g].objectStoreNames]}listIndexes(e){return[...this[g].transaction([e]).objectStore(e).indexNames]}[E](e,t,r,s,n,a,o,l){var u=(s,u)=>new Promise((c,h)=>{if(s instanceof IDBKeyRange);else if(Array.isArray(s))if(0===s.length)s=void 0;else if(1===s.length)s=IDBKeyRange.only(s[0]);else if(void 0===s[0]&&void 0===s[1])s=void 0;else if(void 0===s[0]){var d;s=IDBKeyRange.upperBound(s[1],null===(d=s[2])||void 0===d||d)}else if(void 0===s[1]){var v;s=IDBKeyRange.lowerBound(s[0],null!==(v=s[2])&&void 0!==v&&v)}else{var p,f;s=IDBKeyRange.bound(s[0],s[1],null!==(p=s[2])&&void 0!==p&&p,null===(f=s[3])||void 0===f||f)}else void 0!==s&&null!==s&&(s=IDBKeyRange.only(s));var g=0;t.openCursor(s,r).addEventListener("success",r=>{var s=r.target.result;if(!s)return c({record:null,result:null,index:g});var h=s.source,d=h.objectStore?h.objectStore.name:t.name;this[_][d]=this[_][d]||{};var v=this[_][d],p=s.primaryKey,f=e?e.from(s.value):s.value,b=i.Bindable.makeBindable(f),y={database:this[P],key:T.getPrimaryKey(b),record:f,store:t.name,type:"read",subType:"select",origin:o},w=f[T.BeforeRead]?f[T.BeforeRead](y):null;if(a>g++||!1===w)return s.continue();v[p]?Object.assign(v[p],f):(f[m]=Symbol.for(p),v[p]=f),y.record=f,v[p][T.AfterRead]&&v[p][T.AfterRead](y);if(this.dispatchEvent(new CustomEvent("read",{detail:y,cancelable:!0}))){var j=e?e.from(v[p]):v[p];j[m]=Symbol.for(p);var E=l?l(j):j,S=u?u(E,g):E;if(n&&g-a>=n)return a+=n,c({mapped:E,result:S,index:g})}s.continue()})}),c=[];s=s&&s.length?s.slice():[[]];var h=(e,t)=>(c.push(e),s.length?u(s.shift(),t).then(e=>h(e,t)):1===c.length?c[0]:c);return e=>u(s.shift(),e).then(t=>h(t,e))}static getPrimaryKey(e){return e[m]?e[m]:null}static destroyDatabase(){return new Promise((e,t)=>{var r=indexedDB.delete(dbName);r.onerror=(e=>{T.dispatchEvent(new CustomEvent("error",{detail:{database:dbName,error:e,type:"destroy"}})),t(e)}),r.onsuccess=(t=>{delete this[b][dbName],e(dbName)})})}getObjectStores(e){return[...this[g].objectStoreNames]}getStoreIndexes(e){var t=this[g].transaction([e],"readonly"),r=[...t.objectStore(e).indexNames];return t.abort(),r}setStoreMeta(e,t,r){localStorage.setItem(`::::cvdb::${e}::${t}`,JSON.stringify(r))}getStoreMeta(e,t,r=null){var i=localStorage.getItem(`::::cvdb::${e}::${t}`),s=null!==i?JSON.parse(i):r;return null===s?r:s}createObjectStore(e,t){var r=this[g].createObjectStore(e,t);return this.setStoreMeta(e,"store",t),r}deleteObjectStore(e){return this[g].deleteObjectStore(e)}checkHighWaterMark(e,t,r){return this.getStoreMeta(e,"highWater",0)}setHighWaterMark(e,t,r,i){var s=t[this[y][e].highWater],n=this.getStoreMeta(e,"highWater",0);this.setStoreMeta(e,"highWater",s),this.dispatchEvent(new CustomEvent("highWaterMoved",{detail:{database:this[P],record:t,store:e,type:"highWaterMoved",subType:i,origin:r,oldValue:n,value:s}}))}checkLowWaterMark(e,t,r){return this.getStoreMeta(e,"lowWater",1/0)}setLowWaterMark(e,t,r,i){var s=t[this[y][e].highWater],n=this.getStoreMeta(e,"lowWater",null);this.setStoreMeta(e,"lowWater",s),this.dispatchEvent(new CustomEvent("lowWaterMoved",{detail:{database:this[P],record:t,store:e,type:"lowWaterMoved",subType:i,origin:r,oldValue:n,value:s}}))}}e.Database=T,Object.defineProperty(T,b,{value:[]}),Object.defineProperty(T,"BeforeDelete",{value:l}),Object.defineProperty(T,"AfterDelete",{value:u}),Object.defineProperty(T,"BeforeWrite",{value:a}),Object.defineProperty(T,"AfterWrite",{value:o}),Object.defineProperty(T,"BeforeInsert",{value:c}),Object.defineProperty(T,"AfterInsert",{value:h}),Object.defineProperty(T,"BeforeUpdate",{value:d}),Object.defineProperty(T,"AfterUpdate",{value:v}),Object.defineProperty(T,"BeforeRead",{value:p}),Object.defineProperty(T,"AfterRead",{value:f}),Object.defineProperty(T,"PKSymbol",{value:m}),Object.defineProperty(T,"PrimaryKey",{value:m});try{Object.defineProperty(T,j,{value:new EventTarget})}catch(e){Object.defineProperty(T,j,{value:document.createDocumentFragment()})}var S=function(e){Object.defineProperty(T,e,{value:(...t)=>T[j][e](...t)})};for(var O of["addEventListener","removeEventListener","dispatchEvent"])S(O)}),require.register("curvature/model/Model.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Model=void 0;var i=t("../base/Cache"),s=t("../base/Bindable"),n=t("./Database");function a(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=Symbol("Changed"),l=Symbol("Deleted"),u=Symbol("Saved"),c=Symbol("Keys");class h{static get keyProps(){return["id","class"]}constructor(){return a(this,"id",void 0),a(this,"class",void 0),Object.defineProperty(this,o,{value:s.Bindable.make({})}),Object.defineProperty(this,l,{writable:!0,value:!1}),Object.defineProperty(this,u,{writable:!0,value:!1}),Object.defineProperty(this,c,{writable:!0,value:new Set}),s.Bindable.make(this)}static from(e,t=!1){var r=this.keyProps,s=r.map(t=>e[t]);s.unshift(this.name);var n=s.join("::"),a="models-by-type-and-publicId",l=i.Cache.load(n,!1,a),c=l||new this;for(var h of r){var d,v;c[h]=null!==(d=null!==(v=c[h])&&void 0!==v?v:e[h])&&void 0!==d?d:null}if(c.consume(e),!l){i.Cache.store(n,c,0,a);var p=!1;c.bindTo((e,t,r,i)=>{"symbol"!=typeof t&&e!==r[t]&&(c[o][t]=p,c[u]=!(p||!c[u]))}),0===Object.keys(c[o]).length&&(c[u]=t),p=!0}return c}consume(e,t=!1){var r=h.keyProps,s=(e,r)=>{if(r&&"object"==typeof r&&r.constructor.keyProps){var s=r.constructor.keyProps.map(e=>r[e]).join("::"),n=i.Cache.load(s,!1,"models-by-type-and-publicId");n&&(n.consume(r),r=n)}!t&&this[o][e]||(this[e]=r)};for(var a of(n.Database.PKSymbol in e&&s(n.Database.PKSymbol,e[n.Database.PKSymbol]),this[c]=new Set([...this[c],...Object.keys(this),...Object.keys(e)]),this[c]))!t&&this[o][a]||r.includes(a)||a in e&&s(a,e[a])}changed(){this[u]=!1}markDeleted(){for(var e in this[o])this[o][e]=!1;this[l]=!0,this[u]=!1}markStored(){for(var e in this)this[o][e]=!1;this[l]=!1,this[u]=!0}isSaved(){return this[u]}}e.Model=h,Object.defineProperty(h,"Changed",{value:o}),Object.defineProperty(h,"Deleted",{value:l}),Object.defineProperty(h,"Saved",{value:u})}),require.register("curvature/model/SourceWorker.js",function(e,t,r){"use strict"}),require.register("curvature/model/Store.js",function(e,t,r){"use strict";function i(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}Object.defineProperty(e,"__esModule",{value:!0}),e.Store=void 0;e.Store=class{constructor(){i(this,"storeName","test-store")}static setHighWaterMark(e,t,r){}static setLowWaterMark(e,t,r){}static checkHighWaterMark(e,t){}static checkLowWaterMark(e,t){}static create(e,t){}static delete(e){}select({index:e,range:t=null,ranges:r=[],direction:i="next",limit:s=0,offset:n=0,type:a=!1,origin:o,map:l}){}insert(e,t={}){}update(e,t={}){}delete(e,t){}getMeta(e,t=null){}setMeta(e,t){}listIndexes(){}clear(){}}}),require.register("curvature/net/Elicit.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Elicit=void 0;var i=t("curvature/base/Mixin"),s=t("curvature/mixin/EventTargetMixin"),n=t("curvature/mixin/PromiseMixin");function a(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var o=Symbol("IterateDownload"),l=Symbol("Retry"),u=Symbol("HandleFirstByte"),c=Symbol("HandleProgress"),h=Symbol("HandleComplete"),d=Symbol("HandleHeaders"),v=Symbol("HandleClose"),p=Symbol("HandleError"),f=Symbol("HandleOpen"),m=Symbol("HandleFail"),g=Symbol("FetchDeferrer"),b=Symbol("LastChunkSize"),y=Symbol("LastChunkTime"),w=Symbol("Options"),j=Symbol("Fetch"),E=Symbol("Type"),P=Symbol("Url"),_=Symbol("RetriesLeft"),T=Symbol("TimeoutLeft"),S=Symbol("Timeout"),O=Symbol("Timer"),C=Symbol("Canecller"),k=Symbol("Caneclled"),x=Symbol("Paused"),R=Symbol("Received"),M=Symbol("Length"),A=Symbol("Opened"),B=Symbol("Closed"),N=Symbol("Start"),D=Symbol("First"),L=Symbol("End");class I extends(i.Mixin.with(s.EventTargetMixin,n.PromiseMixin)){static pool(e){e.finally(()=>{if(this.running.delete(e),this.backlog.length){var t=this.backlog.shift();this.running.add(t),t.open()}}),this.running.size<5?(this.running.add(e),e.open()):this.backlog.push(e)}constructor(e,t={}){super(),this[_]=t.retries||5,this[S]=t.timeout||4500,this[T]=t.maxTimeout||this[S]*this[_],this[g]=null,this[y]=0,this[b]=0,this[k]=!1,this[R]=0,this[x]=!1,this[B]=0,this[w]=Object.assign({},t),this[P]=e,t.defer?this[j]=new Promise(e=>this[g]=e):this.open()}open(){if(!this[A]||this[B]){this[N]||(this[N]=Date.now()),this[C]=new AbortController,this[w].signal=this[C].signal,this[A]=Date.now(),this[B]=0,this[D]=0,this[j]=fetch(this[P],this[w]).then(e=>this[f](e)).catch(e=>this[p](e));this[O]=setTimeout(()=>{if(!this[D]){if(this[C].abort(),this[v](),this[T]=Math.max(0,this[T]-this[S]),this[T])return;this[m](new Error("Timed out."))}},this[S])}}headers(){return this[j].then(({response:e,stream:t})=>e.headers)}json(){return this[j].then(({response:e,stream:t})=>{return new Response(t,{headers:{"Content-Type":"application/json"}}).json()})}text(){return this[j].then(({response:e,stream:t})=>{return new Response(t,{headers:{"Content-Type":this.type}}).text()})}css(){return this.text().then(e=>{var t=new CSSStyleSheet;return t.replace(e),t})}blob(){return this[j].then(({response:e,stream:t})=>{return new Response(t,{headers:{"Content-Type":e.headers.get("Content-Type")}}).blob()})}objectUrl(){return this.blob().then(e=>URL.createObjectURL(e))}dataUri(){return this.blob().then(e=>new Promise((t,r)=>{var i=new FileReader;i.onload=(e=>t(i.result)),i.onerror=(e=>r(i.error)),i.onabort=(e=>r(new Error("Read aborted"))),i.readAsDataURL(e)}))}buffer(){return this[j].then(({response:e,stream:t})=>{return new Response(t,{headers:{"Content-Type":e.headers.get("Content-Type")}}).arrayBuffer()})}bytes(){return this.buffer().then(e=>new Uint8Array(e))}cancel(){this.emitCancelEvent()&&(this[C].abort(),this[k]=!0,this.emitCancelledEvent())}pause(){this[L]||this[x]||this[B]||this.emitPauseEvent()&&(this[x]=!0,this.emitPausedEvent())}unpause(){!this[L]&&this[x]&&this.emitUnpauseEvent()&&(this[x]=!1,this.emitUnpausedEvent())}get done(){return!!this[L]}get type(){return this[E]}get totalTime(){return this[L]?this[L]-this[N]:Date.now()-this[N]}get waitTime(){return this[D]?this[D]-this[A]:Date.now()-this[A]}get loadTime(){return this[A]?this[B]?this[B]-this[D]:Date.now()-this[D]:0}get speed(){return this[A]?((e=this[L]?this[L]-this[y]:Date.now()-this[y])||(e=.01),this[b]/e):0;var e}get received(){return this[R]}get length(){return this[M]}get isPaused(){return this[x]}[o](e,t,r){this[c](r,0,null);var i=Date.now(),s=1,n=({done:e,value:n})=>e?(t.close(),this[h]()):(t.enqueue(n),this[R]+=n.length,this[D]||this[u](n),this[c](r,this[R],n),this[y]=i,this[b]=s,i=Date.now(),s=n.length,a()),a=()=>this[k]?e.cancel():this[x]?new Promise(e=>{setTimeout(()=>e(a()),100)}):e.read().then(e=>n(e)).catch(e=>this[p](e));return a()}[l](){if(this.emitRetryEvent()&&!(this[_]<=0))return this[C].abort(),this[v](),this[R]=0,this[_]--,this.open()}[f](e){var t=e.body.getReader(),r=this[M]||Number(e.headers.get("Content-Length")),i=this[E]||e.headers.get("Content-Type");this[M]=r,this[E]=i,this[d](e.headers),this[g]&&this[g](this[j]);var s=this;return{response:e,stream:new ReadableStream({start(e){s[o](t,e,r)}})}}[v](){this[B]=Date.now(),this.emitCloseEvent()}[d](e){this.emitHeadersEvent(e)}[c](e,t,r){this.emitProgressEvent(e,t,r)}[h](){this[L]=Date.now(),this[v](),this.emitCompleteEvent(),this[n.PromiseMixin.Accept]()}[p](e){return console.warn(`[${e.constructor.name}] ${e.code}: ${e.message}`,e),this.emitErrorEvent(e)?this[m](e):this[l]()}[m](e){return this[L]=Date.now(),this[v](),this.emitFailEvent(e),this[n.PromiseMixin.Reject](e)}[u](e){clearInterval(this[O]),this[D]=Date.now(),this.emitFirstByteEvent(e)}emitProgressEvent(e,t,r){var i=e?t/e:0,s=this.totalTime,n=this.loadTime,a=this.waitTime,o=this.speed;return this.dispatchEvent(new CustomEvent("progress",{detail:{length:e,received:t,done:i,speed:o,loadTime:n,waitTime:a,totalTime:s,value:r}}))}emitOpenEvent(){return this.dispatchEvent(new CustomEvent("open"))}emitCloseEvent(){return this.dispatchEvent(new CustomEvent("close"))}emitFirstByteEvent(e){return this.dispatchEvent(new CustomEvent("firstByte",{detail:{received:e}}))}emitHeadersEvent(e){return this.dispatchEvent(new CustomEvent("headers",{detail:{headers:e}}))}emitCompleteEvent(){return this.dispatchEvent(new CustomEvent("complete"))}emitErrorEvent(){return this.dispatchEvent(new CustomEvent("error",{cancelable:this[_]>0}))}emitRetryEvent(){return this.dispatchEvent(new CustomEvent("retry",{cancelable:!0}))}emitFailEvent(){return this.dispatchEvent(new CustomEvent("fail"))}emitPauseEvent(){return this.dispatchEvent(new CustomEvent("pause",{cancelable:!0}))}emitPausedEvent(){this.dispatchEvent(new CustomEvent("paused"))}emitUnpauseEvent(){return this.dispatchEvent(new CustomEvent("unpause",{cancelable:!0}))}emitUnpausedEvent(){this.dispatchEvent(new CustomEvent("unpaused"))}emitCancelEvent(){return this.dispatchEvent(new CustomEvent("cancel",{cancelable:!0}))}emitCancelledEvent(){return this.dispatchEvent(new CustomEvent("cancelled"))}}e.Elicit=I,a(I,"backlog",[]),a(I,"running",new Set)}),require.register("curvature/net/RtcClient.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RtcClient=void 0;var i=t("curvature/base/Mixin"),s=t("curvature/mixin/EventTargetMixin");function n(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.RtcClient=class extends(i.Mixin.with(s.EventTargetMixin)){constructor(e){super(),n(this,"candidateTimeout",500),this.peerClient=new RTCPeerConnection(e),this.peerClientChannel=this.peerClient.createDataChannel("chat"),this.peerClientChannel.addEventListener("open",e=>{var t=new CustomEvent("open",{detail:e.data});t.originalEvent=e,this.dispatchEvent(t),this.connected=!0}),this.peerClientChannel.addEventListener("close",e=>{var t=new CustomEvent("close",{detail:e.data});t.originalEvent=e,this.dispatchEvent(t),this.connected=!1}),this.peerClientChannel.addEventListener("message",e=>{var t=new CustomEvent("message",{detail:e.data});t.originalEvent=e,this.dispatchEvent(t)})}send(e){console.log(this.peerClientChannel.readyState),this.peerClientChannel&&this.peerClientChannel.send(e)}close(){this.peerClientChannel&&this.peerClientChannel.close()}offer(){this.peerClient.createOffer().then(e=>{this.peerClient.setLocalDescription(e)});var e=new Set;return new Promise(t=>{var r=null;this.peerClient.addEventListener("icecandidate",i=>{i.candidate&&(e.add(i.candidate),r&&clearTimeout(r),r=setTimeout(()=>t(this.peerClient.localDescription),this.candidateTimeout))})})}accept(e){var t=new RTCSessionDescription(e);this.peerClient.setRemoteDescription(t)}}}),require.register("curvature/net/RtcServer.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.RtcServer=void 0;var i=t("curvature/base/Mixin"),s=t("curvature/mixin/EventTargetMixin");function n(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}e.RtcServer=class extends(i.Mixin.with(s.EventTargetMixin)){constructor(e){super(),n(this,"candidateTimeout",500),this.peerServer=new RTCPeerConnection(e),this.peerServer.addEventListener("datachannel",e=>{this.peerServerChannel=e.channel,this.peerServerChannel.addEventListener("open",e=>{var t=new CustomEvent("open",{detail:e.data});t.originalEvent=e,this.dispatchEvent(t),this.connected=!0}),this.peerServerChannel.addEventListener("close",e=>{var t=new CustomEvent("close",{detail:e.data});t.originalEvent=e,this.dispatchEvent(t),this.connected=!1}),this.peerServerChannel.addEventListener("message",e=>{var t=new CustomEvent("message",{detail:e.data});t.originalEvent=e,this.dispatchEvent(t)})})}send(e){this.peerServerChannel&&"open"===this.peerServerChannel.readyState&&this.peerServerChannel.send(e)}close(){this.peerServerChannel&&this.peerServerChannel.close()}answer(e){return new Promise(t=>{this.peerServer.setRemoteDescription(e),this.peerServer.createAnswer(e=>this.peerServer.setLocalDescription(e),e=>console.error(e));var r=new Set,i=null;this.peerServer.addEventListener("icecandidate",e=>{e.candidate&&(r.add(e.candidate),i&&clearTimeout(i),i=setTimeout(()=>t(this.peerServer.localDescription),this.candidateTimeout))})})}}}),require.register("curvature/service/CloudService.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CloudService=void 0;var i=t("curvature/base/Router");class s{static handleFetch(e){var t=new URL(e.request.url),r=t.pathname+t.search;for(var s of this.routeHandlers)return i.Router.match(r,{routes:s}).then(e=>("object"==typeof e&&e instanceof Response||(e=new Response(e)),e))}}e.CloudService=s,Object.defineProperty(s,"routeHandlers",{value:new Set}),globalThis.addEventListener("fetch",e=>{e.respondWith(s.handleFetch(e))})}),require.register("curvature/service/EventPipe.js",function(e,t,r){"use strict";function i(e){throw new TypeError('"'+e+'" is read-only')}Object.defineProperty(e,"__esModule",{value:!0}),e.EventPipe=void 0;e.EventPipe=(e=>{var t=new Headers;t.set("Access-Control-Allow-Methods","GET, OPTIONS"),t.set("Access-Control-Allow-Origin","*"),t.set("Cache-Control","no-cache"),t.set("Content-Type","text/event-stream"),t.set("Connection","keep-alive");var{readable:r,writable:s}=new TransformStream,n=s.getWriter(),a=new TextEncoder,o=[];for(var l of e)l instanceof Promise||(Promise.resolve(l),i("getEvent")),l.then(e=>{var t,r;e&&"object"==typeof e||(e={data:e}),n.write(a.encode(`event: ${null!==(t=e.type)&&void 0!==t?t:"ServerEvent"}\n`+`data: ${JSON.stringify(e.data)}\n`+`id: ${null!==(r=e.id)&&void 0!==r?r:Date.now()}\n\n`))}),o.push(l);return Promise.all(o).then(()=>n.close()),new Response(r,{status:"200",statusText:"OK",headers:t})})}),require.register("curvature/service/Service.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Service=void 0;var i=t("../base/Router");function s(e){throw new TypeError('"'+e+'" is read-only')}class n{static register(e,t="/"){if(!("serviceWorker"in navigator))return Promise.reject("Service Workers not supported.");var r=navigator.serviceWorker;return r.register(e,{scope:t}),r.ready.then(e=>{var t=e.active;t&&this.setupWorker(t)}),r.ready}static request({command:e,args:t,echo:r,notify:i,to:n=null,broadcast:a=!1}){var o=Number(1/Math.random()).toString(36),l=new Promise(e=>{this.incomplete.set(o,e)});for(var[u,c]of this.workers){if("redundant"===c.state){if(!navigator.serviceWorker.controller||navigator.serviceWorker.controller.scriptURL!==u||"activated"!==navigator.serviceWorker.controller.state)return Promise.reject("Worker has been updated, connection lost. Please refresh the page.");navigator.serviceWorker.controller,s("worker"),this.setupWorker(c)}c.postMessage({correlationId:o,broadcast:a,command:e,notify:i,args:t,echo:r,to:n})}return l}static broadcast({command:e,args:t,echo:r,notify:i}){this.request({command:e,args:t,echo:r,notify:i,broadcast:!0})}static handleResponse(e){e.target.ready.then(e=>this.setupWorker(e.active));var t=e.data;if(t.to||t.correlationId)if(this.incomplete.has(t.correlationId)){var r=this.incomplete.get(t.correlationId);this.incomplete.delete(t.correlationId),r(t.result)}else t.broadcast?this.handleBroadcast(e):t.to&&this.handleMessage(e)}static handleRequest(e){if(e.origin===globalThis.origin){var t=e.data,r=Promise.resolve("Unexpected request.");if(t.echo)r=Promise.resolve(t.echo);else if(t.notify){var i=t.args||[];r=globalThis.registration.getNotifications().then(e=>(e.forEach(e=>this.notifications.set(e.tag,e)),globalThis.registration.showNotification(...i))).then(()=>globalThis.registration.getNotifications()).then(t=>{var r=e.data.args&&e.data.args[1]&&e.data.args[1].tag;return new Promise(t=>{var i;this.notifyClients.has(r)?i=this.notifyClients.get(r):(i=new Map,this.notifyClients.set(r,i)),i.set(e.source,t)})})}else if(t.command){var s=t.command,n=t.args||[];for(var a of this.serviceHandlers)if("function"==typeof a[s]){r=a[s](...n);break}}if(typeof r!==Promise&&(r=Promise.resolve(r)),t.broadcast){var o=e.source.id;globalThis.clients.matchAll({type:"window",includeUncontrolled:!0}).then(e=>{e.forEach(e=>{r.then(r=>e.postMessage({...t,result:r,source:o}))})})}else if(t.to){var l=e.source.id;globalThis.clients.get(t.to).then(e=>{r.then(r=>{e.postMessage({...t,result:r,source:l})})})}else r.then(r=>e.source.postMessage({...t,result:r}))}}static setupWorker(e){this.workers.set(e.scriptURL,e),navigator.serviceWorker.addEventListener("message",e=>this.handleResponse(e))}static handleInstall(e){for(var t of(globalThis.skipWaiting(),this.pageHandlers))"function"==typeof t.handleInstall&&t.handleInstall(e)}static handleActivate(e){for(var t of this.pageHandlers)"function"==typeof t.handleActivate&&t.handleActivate(e)}static handleError(e){for(var t of(console.error(e),this.pageHandlers))"function"==typeof t.handleError&&t.handleError(e)}static handlePush(e){}static handleSync(e){}static handlePeriodicSync(e){}static handleFetch(e){var t=new URL(e.request.url),r=t.pathname+t.search;for(var s of this.routeHandlers)return i.Router.match(r,{routes:s},{event:e}).then(e=>{if(void 0!==e)return"object"==typeof e&&e instanceof Response||(e=new Response(e)),e})}static handleBroadcast(e){for(var t of this.pageHandlers)"function"==typeof t.handleBroadcast&&t.handleBroadcast(e)}static handleMessage(e){for(var t of this.pageHandlers)"function"==typeof t.handleMessage&&t.handleMessage(e)}static notify(e,t={},r=!1){return t.tag=t.tag||([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16)),new Promise((e,t)=>{Notification.requestPermission(t=>{e(t)})}).then(i=>this.request({notify:!0,args:[e,t],broadcast:r}))}static handleNotifyClicked(e){if(this.notifyClients.has(e.notification.tag)){var t=[];for(this.notifyClients.get(e.notification.tag).forEach((r,i)=>{r({action:e.action,data:e.notification.data,click:Date.now(),time:e.notification.timestamp,tag:e.notification.tag}),t.push(i)});t.length;){if(t.pop().focus())break}this.notifyClients.delete(e.notification.tag)}for(var r of this.pageHandlers)"function"==typeof r.handleNotifyClicked&&r.handleNotifyClicked(e);e.notification.close()}static handleNotifyClosed(e){this.notifyClients.has(e.notification.tag)&&this.notifyClients.get(e.notification.tag).forEach(t=>t({action:void 0,data:e.notification.data,close:Date.now(),time:e.notification.timestamp,tag:e.notification.tag}));if(this.notifyClients.delete(e.notification.tag))for(var t of this.pageHandlers)"function"==typeof t.handleNotifyDismissed&&t.handleNotifyDismissed(e);for(var r of this.pageHandlers)"function"==typeof r.handleNotifyClosed&&r.handleNotifyClosed(e)}}e.Service=n,Object.defineProperty(n,"serviceHandlers",{value:new Set}),Object.defineProperty(n,"routeHandlers",{value:new Set}),Object.defineProperty(n,"pageHandlers",{value:new Set}),Object.defineProperty(n,"notifications",{value:new Map}),Object.defineProperty(n,"notifyClients",{value:new Map}),Object.defineProperty(n,"incomplete",{value:new Map}),Object.defineProperty(n,"workers",{value:new Map}),globalThis.document||(globalThis.addEventListener("install",e=>n.handleInstall(e)),globalThis.addEventListener("activate",e=>n.handleActivate(e)),globalThis.addEventListener("error",e=>n.handleActivate(e)),globalThis.addEventListener("message",e=>n.handleRequest(e)),globalThis.addEventListener("fetch",e=>{e.waitUntil(new Promise(t=>{n.handleFetch(e).then(r=>{r&&e.respondWith(r),t()})}))}),globalThis.addEventListener("push",e=>n.handlePush(e)),globalThis.addEventListener("notificationclose",e=>n.handleNotifyClosed(e)),globalThis.addEventListener("notificationclick",e=>n.handleNotifyClicked(e)),globalThis.addEventListener("sync",e=>n.handleSync(e)),globalThis.addEventListener("periodicsync",e=>n.handlePeriodicSync(e)))}),require.register("curvature/strings/Parser.js",function(e,t,r){"use strict"}),require.register("curvature/tag/LazyTag.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LazyTag=void 0;var i=t("./ScrollTag"),s=t("../base/Dom");e.LazyTag=class extends i.ScrollTag{constructor(e,t,r,i,n){super(e,t,r,i,n),this.element.classList.remove("cv-visible"),this.element.classList.add("cv-not-visible"),this.bindTo("visible",e=>{e&&(this.afterScroll&&clearTimeout(this.afterScroll),this.afterScroll=setTimeout(()=>{this.element&&(this.element.classList.add("cv-visible"),this.element.classList.remove("cv-not-visible"),s.Dom.mapTags(this.element,"[cv-lazy-style]",e=>{var t=e.getAttribute("cv-lazy-style"),r=e.getAttribute("style");e.setAttribute("style",r+";"+t),e.removeAttribute("cv-lazy-style")}))},.5*(this.offsetTop||this.element.offsetTop)+.5*this.element.offsetLeft))})}}}),require.register("curvature/tag/PopOutTag.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PopOutTag=void 0;t("../base/Bindable"),t("../base/Dom");var i=t("../base/Tag");class s extends i.Tag{constructor(e,t,r,i,s){super(e,t,r,i,s),this.defaultStyle=e.getAttribute("style")||"",this.poppedOut=!1,this.moving=!1,this.hostSelector=e.getAttribute("cv-pop-to"),this.popMargin=e.getAttribute("cv-pop-margin")||0,this.popSpeed=e.getAttribute("data-pop-speed")||1750,e.removeAttribute("cv-pop-to"),e.removeAttribute("cv-pop-margin"),e.removeAttribute("data-pop-speed"),this.verticalDuration=.4,this.horizontalDuration=.1,this.unpoppedStyle="",this.previousScroll=0,this.bodyStyle="",this.bodyScroll=0,this.element.classList.add("unpopped"),this.scrollStyle="",this.existingStyle="",this.popTimeout=null,this.rect=null,this.transformRect=null,this.clickListener=(e=>{if(this.rect=this.element.getBoundingClientRect(),!this.poppedOut){this.distance=Math.sqrt(this.rect.top**2+this.rect.left**2);var t=this.popSpeed,r=window.innerWidth-this.rect.right,i=window.innerHeight-this.rect.bottom,s=(this.rect.left+r)/2,n=(this.rect.top+i)/2;this.horizontalDuration=s/t,this.verticalDuration=n/t,this.horizontalDuration<.1&&(this.horizontalDuration=.1),this.verticalDuration<.1&&(this.verticalDuration=.1),this.horizontalDuration>.4&&(this.horizontalDuration=.4),this.verticalDuration>.4&&(this.verticalDuration=.4)}this.element.contains(e.target)&&(e.stopPropagation(),e.preventDefault(),this.moving||(this.poppedOut?e.target.matches(".closeButton")&&this.poppedOut&&this.unpop():this.pop()))}),this.escapeListener=(e=>{this.poppedOut&&"Escape"===e.key&&this.unpop()}),this.resizeListener=(e=>{if(this.poppedOut){for(var t=this.element;t.parentNode&&!t.matches(this.hostSelector)&&t.parentNode!=document;)t=t.parentNode;var r=t.getBoundingClientRect(),i=this.existingStyle+this.unpoppedStyle,s=r.x,n=r.y+document.documentElement.scrollTop,a=r.width,o=r.height;this.transformRect&&(s-=this.transformRect.x,n-=this.transformRect.y),this.popMargin,this.popMargin,this.popMargin,this.popMargin,i+=`;\n\t\t\t\tz-index:    99999;\n\t\t\t\ttransition-duration: 0s;\n\t\t\t\toverflow: hidden;\n\t\t\t\tposition:  fixed;\n\t\t\t\tleft:      ${s}px;\n\t\t\t\ttop:        ${n}px;\n\t\t\t\twidth:      ${a}px;\n\t\t\t\theight:     ${o}px;\n\t\t\t\toverflow-y: auto;\n\t\t\t\ttransition-duration: 0s;\n\t\t\t`,this.element.setAttribute("style",i)}}),this.element.___clickListener___||(Object.defineProperty(this.element,"___scrollListeners___",{enumerable:!1,writable:!0}),e.___clickListener___=this.clickListener,e.___escapeListener___=this.escapeListener,e.___resizeListener___=this.resizeListener,this.element.addEventListener("click",e.___clickListener___),window.addEventListener("keyup",e.___escapeListener___),window.addEventListener("resize",e.___resizeListener___),this.cleanup.push((e=>()=>{e.removeEventListener("click",e.___clickListener___),window.removeEventListener("keyup",e.___escapeListener___),window.removeEventListener("resize",e.___resizeListener___)})(e)))}static popLevel(){return this.level||(this.level=0),this.level++,this.level}static unpopLevel(){return this.level||(this.level=0),this.level--,this.level<0&&(this.level=0),this.level}pause(e=!0){super.pause(e),e&&(document.body.setAttribute("style",this.bodyStyle),document.body.setAttribute("style",""))}pop(){s.popLevel(),this.previousScroll=window.scrollY,this.rect=this.element.getBoundingClientRect(),this.existingStyle=this.element.getAttribute("style");var e=this.element;for(this.transformRect=null;e.parentNode&&!e.matches(this.hostSelector)&&e.parentNode!=document;)e=e.parentNode,this.transformRect||"none"===getComputedStyle(e).transform||(this.transformRect=e.getBoundingClientRect());var t=e.getBoundingClientRect();this.element.classList.add("popping");var r=this.rect.x,i=this.rect.y,n=this.rect.width,a=this.rect.height;this.transformRect&&(r-=this.transformRect.x,i-=this.transformRect.y),window.requestAnimationFrame(()=>{this.unpoppedStyle=`\n\t\t\t\t;position:  fixed;\n\t\t\t\tleft:       ${r}px;\n\t\t\t\ttop:        ${i}px;\n\t\t\t\twidth:      ${n}px;\n\t\t\t\theight:     ${a}px;\n\t\t\t\tz-index:    99999;\n\t\t\t\ttransition-duration: 0s;\n\t\t\t\toverflow: hidden;\n\t\t\t`;var e=t.x,s=t.y+document.documentElement.scrollTop,o=t.width,l=t.height;this.transformRect&&(e-=this.transformRect.x,s-=this.transformRect.y),this.popMargin,this.popMargin,this.popMargin,this.popMargin;var u=this.existingStyle+this.unpoppedStyle;this.element.setAttribute("style",u),setTimeout(()=>{u+=`\n\t\t\t\t\t;left:      ${e}px;\n\t\t\t\t\ttop:        ${s+document.documentElement.scrollTop}px;\n\t\t\t\t\twidth:      ${o}px;\n\t\t\t\t\theight:     ${l}px;\n\t\t\t\t\toverflow-y: auto;\n\t\t\t\t\ttransition: width ${this.horizontalDuration}s ease-out\n\t\t\t\t\t\t, top ${this.verticalDuration}s           ease-out\n\t\t\t\t\t\t, left ${this.horizontalDuration}s        ease-out\n\t\t\t\t\t\t, height ${this.verticalDuration}s        ease-out\n\t\t\t\t\t\t, all ${this.horizontalDuration}s         ease-out;\n\t\t\t\t`,this.moving=!0,this.element.setAttribute("style",u),this.element.classList.add("popped"),this.element.classList.remove("unpopped"),this.element.classList.remove("popping"),this.popTimeout=setTimeout(()=>{if(this.element){this.bodyStyle=document.body.getAttribute("style"),document.body.setAttribute("style","height:100%;overflow:hidden;"),this.moving=!1;var e=new CustomEvent("cvPopped");this.element.dispatchEvent(e),this.scrollStyle=this.element.getAttribute("style")}},1e3*this.horizontalDuration)},33.4),this.poppedOut=!0});var o=new CustomEvent("cvPop",{bubbles:!0,detail:{tag:this,view:this.parent,publicId:this.parent.args.publicId}});this.element.dispatchEvent(o)}unpop(){this.element.classList.add("unpopping"),this.popTimeout&&clearTimeout(this.popTimeout),0==s.level?document.body.setAttribute("style",""):document.body.setAttribute("style",this.bodyStyle||""),s.unpopLevel(),this.rect||(this.rect=this.element.getBoundingClientRect()),window.scrollTo(0,this.previousScroll);var e=this.existingStyle+this.unpoppedStyle+`;transition: width ${this.horizontalDuration}s ease-out\n\t\t\t\t\t, height ${this.verticalDuration}s        ease-out\n\t\t\t\t\t, all ${this.horizontalDuration}s         ease-out;`;this.element.setAttribute("style",e),this.moving=!0,setTimeout(()=>{this.element&&this.element.classList.remove("popped")},1e3*this.horizontalDuration),setTimeout(()=>{if(this.element.classList.add("unpopped"),this.element.classList.remove("unpopping"),this.element){this.element.setAttribute("style",this.defaultStyle),this.moving=!1;var e=new CustomEvent("cvUnpopped");this.element.dispatchEvent(e)}},1e3*this.horizontalDuration);var t=new CustomEvent("cvUnpop",{bubbles:!0,detail:{tag:this,view:this.parent,publicId:this.parent.args.publicId}});this.element.dispatchEvent(t),this.poppedOut=!1}remove(){document.body.setAttribute("style",this.bodyStyle),super.remove()}}e.PopOutTag=s}),require.register("curvature/tag/ScrollTag.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ScrollTag=void 0;var i=t("../base/Tag"),s=t("../base/Dom");t("../base/Bindable");e.ScrollTag=class extends i.Tag{constructor(e,t,r,i,n){super(e,t,r,i,n),this.visible=!1,this.offsetTop=!1,this.offsetBottom=!1,this.attachListener=(t=>{for(var r=t.target;r.parentNode;)r=r.parentNode;r!==window&&r!==document||t.target===e&&(this.addScrollListener(t.target),this.addResizeListener(t.target),this.scrolled(t.target),t.target.removeEventListener("cvDomAttached",this.attachListener))}),this.element.addEventListener("cvDomAttached",this.attachListener),this.cleanup.push((e=>()=>{e.removeEventListener("cvDomAttached",this.attachListener)})(this.element)),this.bindTo("visible",e=>{var t;t=e?new Event("cvScrolledIn"):new Event("cvScrolledOut"),s.Dom.mapTags(this.element,!1,e=>{e.dispatchEvent(t)}),this.element.dispatchEvent(t)}),this.bindTo("offsetTop",e=>{var t=new CustomEvent("cvScrolled",{detail:{offset:e}});s.Dom.mapTags(this.element,!1,e=>{e.dispatchEvent(t)}),this.element.dispatchEvent(t)})}scrolled(e){var t=this.element;if(t){var r=!1,i=t.getBoundingClientRect();i.bottom>0&&i.top<window.innerHeight&&(r=!0),this.proxy.visible=r,this.proxy.offsetTop=i.top||0,this.proxy.offsetBottom=i.bottom||0}}addScrollListener(e){if(!e.___scrollListener___){Object.defineProperty(e,"___scrollListener___",{enumerable:!1,writable:!0}),e.___scrollListener___=(e=>{this.scrolled(e.target)});for(var t=e,r={passive:!0,capture:!0};t.parentNode;)(t=t.parentNode).addEventListener("scroll",e.___scrollListener___,r),this.direct.cleanup.push(((e,t,r)=>()=>{e.removeEventListener("scroll",t.___scrollListener___,r),t=e=null})(t,e,r))}}addResizeListener(e){e.___resizeListener___||(Object.defineProperty(e,"___resizeListener___",{enumerable:!1,writable:!0}),e.___resizeListener___=(e=>{this.scrolled(e.target)}),window.addEventListener("resize",this.resizeListener),this.direct.cleanup.push((t=>()=>{window.removeEventListener("resize",t.___resizeListener___),e.___resizeListener___=null,e=null})(e)))}}}),require.register("curvature/toast/Toast.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Toast=void 0;var i=t("../base/View"),s=t("../base/Bindable"),n=t("./ToastAlert");e.Toast=class extends i.View{static instance(){return this.inst||(this.inst=new this),this.inst}constructor(){super(),this.template='\n\t\t\t<div id = "[[_id]]" cv-each = "alerts:alert" class = "toast">\n\t\t\t\t[[alert]]\n\t\t\t</div>\n\t\t',this.args.alerts=[]}pop(e){this.args.alerts.length,this.args.alerts.push(e),e.decay((e=>()=>{for(var t in this.args.alerts)if(s.Bindable.ref(this.args.alerts[t])===s.Bindable.ref(e))return e.remove(),void delete this.args.alerts[t]})(e))}alert(e,t,r){return this.pop(new n.ToastAlert({title:e,body:t,time:r}))}}}),require.register("curvature/toast/ToastAlert.js",function(e,t,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ToastAlert=void 0;var i=t("../base/View");e.ToastAlert=class extends i.View{constructor(e){super(e),this.args.running=!1,this.args.time=this.args.time||16e3,this.init=this.args.time,this.args.title=this.args.title||"Standard alert",this.args.status="new",this.args.body=this.args.body||"This is a standard alert.",this.template='\n\t\t\t<div id = "[[_id]]" class = "alert toast-[[status]]">\n\t\t\t\t<h3>[[title]]</h3>\n\t\t\t\t<p>[[body]]</p>\n\t\t\t</div>\n\t\t'}decay(e){this.args.running=!0,this.onTimeout(50,()=>{this.args.status=""}),this.onTimeout(300,()=>{this.args.status="decaying"}),this.onTimeout(2400,()=>{this.args.status="imminent"}),this.onTimeout(3500,()=>{this.remove()})}}}),require.register("___globals___",function(e,t,r){})}(),require("___globals___");
